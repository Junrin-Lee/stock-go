# 股票监控系统

> 🤖 **AI Generated Repository**: This entire project was generated by AI, including code architecture, implementation, and documentation.
---

📖 **多语言文档**: [中文](README.md) | [English](README_EN.md)

## 🌟 项目简介

Stock Monitor 是一款为投资者打造的命令行终端股票监控工具。

### 🎯 核心特色

- **🔄 实时监控** - 5秒间隔自动刷新股价数据，掌握每个交易时刻
- **📊 专业分析** - 13列详细数据展示，包含开高低收、盈亏分析、市值统计
- **🎨 智能显示** - 专业股票软件标准配色：红涨绿跌白平，数据一目了然
- **💼 投资组合** - 完整的持仓管理，支持添加、修改、删除股票操作
- **🌐 全球市场** - 支持 A股、美股、港股等主流市场股票代码格式
- **💾 数据持久** - 本地 JSON 存储，投资组合数据永不丢失

## ✨ 功能特性

### 📱 现代化交互界面
- 基于 Bubble Tea 框架的响应式终端 UI
- 实时键盘响应，无需等待确认
- 流畅的状态切换和菜单导航
- 支持方向键、WASD、Vim 风格快捷键

### 📈 实时数据监控
- **自动更新**: 每 5 秒刷新一次股价数据
- **多维度数据**: 现价、开盘价、最高价、最低价、昨收价
- **涨跌分析**: 基于昨收价计算的精确涨跌幅
- **盈亏统计**: 当日盈亏、总盈亏、盈亏率实时计算

### 💼 投资组合管理
- **股票搜索**: 支持代码或中文名称搜索股票信息
- **持仓管理**: 添加、修改、删除投资组合中的股票
- **成本追踪**: 记录购买成本价和持股数量
- **自动计算**: 实时计算市值、盈亏等关键指标

### 🎨 专业数据展示
- 使用 go-pretty 库实现的专业表格布局
- 完美的中文字符宽度对齐
- 智能配色系统：红色（盈利/上涨）、绿色（亏损/下跌）、白色（持平）
- 13列详细数据展示，涵盖所有关键投资指标

## 🚀 快速开始

### 📦 环境要求

- **Go 版本**: 1.18 或更高版本
- **网络连接**: 用于获取实时股票数据
- **系统支持**: Windows、macOS、Linux
- **终端**: 支持彩色显示（推荐）

### ⚡ 安装运行

#### 1️⃣ 克隆项目
```bash
git clone <repository-url>
cd stock-go
```

#### 2️⃣ 安装依赖
```bash
go mod download
```

#### 3️⃣ 编译程序
```bash
go build -o stock-go main.go
```

#### 4️⃣ 运行程序
```bash
./stock-go
```

### 🎮 操作指南

#### ⌨️ 键盘快捷键
- **导航**: `↑↓` 方向键 或 `W/S` 或 `J/K` (Vim 风格)
- **确认**: `Enter` 回车键 或 `Space` 空格键
- **返回**: `ESC` 或 `Q` 键
- **强制退出**: `Ctrl+C`

#### 🏠 主菜单导航
```
=== 股票监控系统 ===

► 股票列表        # 进入实时监控界面
  股票搜索        # 搜索股票信息
  添加股票        # 添加新的投资标的
  修改股票        # 编辑持仓信息
  删除股票        # 移除投资标的
  调试模式: 关闭   # 切换调试信息
  退出           # 保存并退出程序
```

#### 💡 智能启动
- **有持仓数据**: 程序自动进入实时监控模式
- **无持仓数据**: 显示主菜单，引导用户添加股票

## 📊 功能详解

### 📈 实时监控界面

进入监控模式后，系统将显示专业的股票数据表格：

=== 股票实时监控 ===
更新时间(5s): 2024-01-01 15:30:25

| 代码 | 名称 | 现价 | 昨收价 | 开盘 | 最高 | 最低 | 成本价 | 持股数 | 今日涨幅 | 当日盈亏 | 总盈亏 | 盈亏率 | 市值 |
|------|------|------|--------|------|------|------|--------|--------|----------|----------|--------|--------|------|
| SH601138 | 工业富联 | 61.900 | 59.040 | 58.880 | 63.100 | 58.030 | 47.963 | 400 | +4.84% | +1144.00 | +5574.80 | +29.19% | 24760.00 |


ESC、Q键或M键返回主菜单

**表格说明**：
- **智能配色**: 红色表示盈利/上涨，绿色表示亏损/下跌，白色表示持平
- **实时更新**: 每5秒自动刷新最新股价数据
- **精确计算**: 所有盈亏数据基于实时价格精确计算
- **汇总统计**: 底部显示投资组合总体盈亏情况

### 🔍 股票搜索功能

支持多种搜索方式：

```
=== 股票搜索 ===

请输入股票代码或名称: 贵州茅台_

支持格式:
• 中文名称: 贵州茅台, 苹果, 腾讯, 阿里巴巴 等
• 中国股票: SH601138, 000001, SZ000002 等
• 美股: AAPL, TSLA, MSFT 等
• 港股: HK00700 等
```

### ➕ 添加股票流程

**Step 1**: 输入股票代码
```
=== 添加股票 ===

请输入股票代码: SH601138_
支持格式: SH601138, 000001, AAPL 等
```

**Step 2**: 确认股票信息
```
股票代码: SH601138
股票名称: 工业富联
当前价格: 61.900

请输入成本价: 47.963_
```

**Step 3**: 输入持股数量
```
股票代码: SH601138
股票名称: 工业富联  
当前价格: 61.900
成本价: 47.963

请输入股票数量: 400_
```

### ✏️ 修改持仓信息

选择要修改的股票，系统将引导完成成本价和数量的更新：

```
=== 修改股票 ===

选择要修改的股票:

► 1. 工业富联 (SH601138) - 成本价: 47.963, 数量: 400
  2. 恒生科技指数ETF (SH513180) - 成本价: 0.510, 数量: 10000

使用方向键选择，回车确认，ESC或Q键返回
```

## 🌐 支持的股票市场

### 📍 股票代码格式

系统智能识别并支持全球主流股票市场：

| 市场 | 支持格式 | 示例 | 自动转换 |
|------|----------|------|----------|
| 🇨🇳 **A股上交所** | `SH + 6位数字` 或 `6位数字` | `SH601138`, `601138` | `→ 601138.SS` |
| 🇨🇳 **A股深交所** | `SZ + 6位数字` 或 `6位数字` | `SZ000001`, `000001` | `→ 000001.SZ` |
| 🇺🇸 **美股** | 直接使用股票代码 | `AAPL`, `TSLA`, `MSFT` | 无需转换 |
| 🇭🇰 **港股** | `HK + 5位数字` 或 标准格式 | `HK00700`, `0700.HK` | `→ 0700.HK` |

### 💡 中文名称搜索

系统支持使用中文名称搜索股票：

```
中文输入  → 自动匹配
贵州茅台  → SH600519  
中国平安  → SH601318
苹果     → AAPL
特斯拉   → TSLA
腾讯     → 00700.HK
```

## 📡 数据来源与 API

### 🎯 多层级数据策略

系统采用多数据源 + 自动容错机制，确保数据获取的稳定性和可靠性：

```
股票代码 → [中国股票?] → [腾讯API] → [成功?] → 返回数据
                    │              │           │
                    ↓              ↓           ↓ 失败
                [FinnhubAPI] → [成功?] → [模拟数据] → 返回数据
```

### 📊 数据源详情

| 优先级 | API 名称 | 适用市场 | 数据完整度 | 更新频率 |
|:------:|----------|----------|------------|----------|
| 🥇 **1** | **腾讯API** | 🇨🇳 A股市场 | 完整（含开高低收） | 实时 |
| 🥈 **2** | **Finnhub API** | 🇺🇸 美股 / 🇭🇰 港股 | 基础数据 | 实时 |
| 🥉 **3** | **模拟数据** | 所有市场 | 完整演示数据 | 实时生成 |

### 🔄 容错机制

- **自动重试**: API失败后自动尝试下一个数据源
- **智能选择**: 根据股票类型选择最优数据源
- **降级保障**: 最终提供模拟数据确保程序可用

## 📁 项目结构

```
stock-go/
│
├── main.go              # 🚀 主程序文件（含全部逻辑）
├── go.mod               # 📦 Go 模块依赖配置  
├── go.sum               # 🔒 依赖版本锁定文件
│
├── portfolio.json       # 📊 投资组合数据（自动生成）
├── stock-go             # ⚙️ 编译后的可执行文件
│
├── README.md            # 📝 中文文档
└── README_EN.md         # 📝 英文文档
```

### 💾 数据存储

**portfolio.json** 示例：
```json
{
  "stocks": [
    {
      "code": "SH601138",
      "name": "工业富联",
      "cost_price": 47.963,
      "quantity": 400,
      "price": 61.9,
      "change": 2.86,
      "change_percent": 4.84
    }
  ]
}
```

## 🏭 技术架构

### 🔧 核心技术栈

```
🖥️ 用户界面 ← Bubble Tea 框架
     │
     ├─ 📋 数据展示 ← Go-Pretty 表格库
     │
     ├─ 📡 数据获取 ← HTTP Client + 编码转换
     │
     └─ 💾 数据存储 ← JSON 文件
```

### 📦 依赖库详情

| 组件 | 版本 | 功能作用 | 优势特点 |
|------|------|----------|----------|
| **Bubble Tea** | `v1.3.6` | 终端 UI 框架 | • 响应式交互<br>• 实时事件处理<br>• 现代化体验 |
| **Go-Pretty** | `v6.6.8` | 表格布局库 | • 中文字符对齐<br>• 丰富样式支持<br>• 开箱即用 |
| **Golang Text** | `v0.28.0` | 编码转换 | • GBK 到 UTF-8<br>• 多语言支持<br>• 官方库 |

### ⚙️ 安装依赖

```bash
# 自动下载所有依赖
go mod download

# 或者手动安装核心依赖
go get github.com/charmbracelet/bubbletea@v1.3.6
go get github.com/jedib0t/go-pretty/v6@v6.6.8
go get golang.org/x/text@v0.28.0
```

## 系统要求

- Go 1.18 或更高版本
- 网络连接（用于获取股票数据）
- 支持 Windows、macOS、Linux
- 终端支持颜色显示（推荐）

## 🔧 故障排除

### ⚠️ 常见问题及解决方案

| 问题现象 | 可能原因 | 解决方案 |
|----------|----------|----------|
| 🚫 股票数据显示为 0 | • 股票代码错误<br>• 网络连接问题<br>• API 限制 | • 检查代码格式<br>• 检查网络连接<br>• 稍后重试 |
| 🎨 颜色显示异常 | • 终端不支持颜色<br>• ANSI 码问题 | • 更换支持颜色的终端<br>• 检查终端设置 |
| 🔤 中文显示乱码 | • 编码问题<br>• 字体不支持 | • 系统自动处理<br>• 检查终端字体 |
| ⏱️ 响应延迟 | • 网络连接慢<br>• API 响应慢 | • 检查网络状态<br>• 更换网络环境 |

### 🔍 调试模式

在主菜单中开启“调试模式”，可获取更详细的错误信息：

```
=== 股票监控系统 ===

  股票列表
  股票搜索
  添加股票
  修改股票
  删除股票
► 调试模式: 开启    # 点击切换
  退出
```

### 📞 获取帮助

如遇到无法自行解决的问题，请提供以下信息：

- ⚙️ 操作系统版本
- 🚀 Go 语言版本  
- 📄 错误日志截图
- 🌐 网络环境说明
- 💰 相关股票代码

## 🌟 特色功能

### 🎨 智能配色系统

系统采用专业股票软件配色标准：

- 🔴 **红色**: 盈利/上涨数值 (> 0.001)
- 🟢 **绿色**: 亏损/下跌数值 (< -0.001)
- ⚪ **白色**: 持平数值 (≈ 0)，如 0% 涨幅、¥0 盈亏

### 🕰️ 实时更新机制

- **更新频率**: 每 5 秒自动刷新
- **智能缓存**: 避免频繁 API 请求
- **容错机制**: API 失败时自动降级处理

### 📊 精准计算

- **今日涨幅**: 基于昨收价计算 `(当前价 - 昨收价) / 昨收价 × 100%`
- **盈亏统计**: 实时计算当日盈亏、总盈亏、盈亏率
- **市值计算**: 现价 × 持股数量

## 📈 版本更新

### 🎉 v2.5 - 界面逻辑优化 🆕

**新增特性**：
- ✨ **智能启动**: 有投资组合数据时自动进入监控模式
- 🎯 **一键直达**: 主菜单“股票列表”直接进入实时监控
- ⏪ **多键返回**: 支持 ESC、Q、M 键多种返回方式

**体验优化**：
- 🧹 **精简菜单**: 移除重复功能，菜单更加简洁
- 💬 **消息管理**: 修复成功消息长期驻留问题

---

### 📅 历史版本

<details>
<summary>🔽 点击查看版本更新详情信息</summary>

**v2.4 - 股票修改与查看列表增强**
- ✅ 新增修改股票功能：通过交互界面修改已有股票的成本价和持仓数量
- ✅ 增强查看股票列表：实时获取股价，显示今日涨幅、当日盈亏、总盈亏、盈亏率和市值
- ✅ 统一颜色显示逻辑：查看列表与监控界面使用相同的颜色方案
- ✅ 投资组合汇总：查看列表底部显示总体盈亏统计数据
- ✅ 交互优化：修改股票时预填充当前值，提升用户体验

**v2.3 - 智能颜色显示系统**
- ✅ 智能颜色判断：每个数值根据自身值决定颜色
- ✅ 白色持平显示：0值数据显示白色（如今日涨幅0%、当日盈亏0元）
- ✅ 精确浮点数比较：使用epsilon值避免精度问题
- ✅ 专业股票软件颜色标准：红涨绿跌白平

**v2.2 - 股票监控数据增强**
- ✅ 新增开盘价、最高价、最低价显示
- ✅ 实时计算今日涨幅：基于开盘价的涨跌幅度
- ✅ 监控表格升级为13列详细数据展示
- ✅ 优化表格列顺序：今日涨幅位于当日盈亏左侧
- ✅ 腾讯API和模拟数据支持完整价格数据

**v2.1 - 股票列表查看功能**
- ✅ 新增查看股票列表功能，表格显示股票基本信息
- ✅ 显示序号、股票代码、股票名称、持股数量、成本价
- ✅ 投资组合统计信息展示
- ✅ 优化主菜单结构和用户交互体验

**v2.0 - Bubble Tea重构版本**
- ✅ 集成Bubble Tea框架，实现现代化终端界面
- ✅ 实时键盘响应，无需确认输入
- ✅ 使用go-pretty库解决中文字符对齐问题
- ✅ 添加盈亏颜色显示（红色盈利，绿色亏损）
- ✅ 价格显示精度提升至3位小数
- ✅ 股票间分隔线，提升表格可读性

**v1.0 - 基础版本**
- ✅ 多API数据源（腾讯财经、Finnhub、模拟数据）
- ✅ 中文股票名称GBK编码转换
- ✅ 基础命令行交互界面
- ✅ JSON数据持久化存储

</details>

## 📝 使用说明

### ✨ 产品亮点

- 🎮 **现代化体验**: Bubble Tea 框架打造的流畅终端界面
- 🔍 **精准数据**: 3 位小数精度，专业级数据展示
- 🌏 **全球支持**: A股、美股、港股全覆盖支持
- 💾 **数据持久**: JSON 格式本地存储，永不丢失
- 🌈 **智能显示**: 专业股票软件配色方案

### 📅 最佳使用时间

| 时间段 | 市场状态 | 数据质量 |
|---------|----------|----------|
| **09:30-15:00** | 🟢 A股交易时间 | ⭐⭐⭐⭐⭐ 实时数据 |
| **21:30-04:00** | 🇺🇸 美股交易时间 | ⭐⭐⭐⭐⭐ 实时数据 |
| **非交易时间** | 🔴 市场关闭 | ⭐⭐⭐ 昨日收盘价 |

### 🚀 快速上手

1. **第一次使用**: 直接进入主菜单，先添加几只股票
2. **添加后重入**: 程序自动进入监控模式
3. **日常使用**: 直接查看实时数据，需要时调整持仓

---

> 📝 **温馨提示**: 请在交易时间使用获得最准确数据，非交易时间显示的是最后一次交易价格。