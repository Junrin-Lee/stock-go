# 股票监控系统 | Stock Monitor System

> 🤖 **AI Generated Repository**: This entire project was generated by AI, including code architecture, implementation, and documentation.

📖 **Language**: [中文](README.md) | [English](README_EN.md)

一个基于 Go 语言开发的现代化命令行股票实时监控工具，采用 Bubble Tea 框架提供流畅的终端交互体验。

## 功能特性

✅ **现代化交互界面**
- 基于 Bubble Tea 框架的响应式终端界面
- 实时键盘监控，无需确认输入
- 流畅的菜单导航和状态切换
- 支持方向键、WASD、vim风格键位

✅ **股票管理**
- 查看股票列表：表格显示已监控的股票基本信息
- 支持添加/删除股票到投资组合
- 自动获取股票名称，只需输入代码、成本价和数量
- 支持3位小数精度的价格显示
- 数据持久化保存到本地文件

✅ **实时监控**  
- 5秒间隔实时更新股票价格
- 显示当前价格、开盘价、最高价、最低价
- 实时计算今日涨幅：基于开盘价的涨跌幅度
- 计算当日盈亏和总盈亏
- 显示盈亏率和市值

✅ **专业表格显示**
- 使用 go-pretty 库实现专业表格布局
- 完美支持中文字符宽度对齐
- 盈利数字显示红色，亏损显示绿色
- 股票间分隔线，提升可读性
- 13列详细数据：代码、名称、现价、开盘、最高、最低、成本价、持股数、今日涨幅、当日盈亏、总盈亏、盈亏率、市值

## 使用方法

### 1. 编译程序
```bash
go build -o stock-monitor main.go
```

### 2. 运行程序
```bash
./stock-monitor
```

### 3. 操作说明

**键盘控制**：
- `↑↓方向键` 或 `W/S/J/K` - 上下选择菜单项
- `回车键` 或 `空格键` - 确认选择
- `ESC` 或 `Q键` - 退出当前界面/程序
- `Ctrl+C` - 强制退出程序

**主菜单选项：**
- `► 查看股票列表` - 查看已监控的股票基本信息
- `  添加股票` - 添加新股票到投资组合
- `  删除股票` - 删除投资组合中的股票  
- `  开始监控` - 启动实时监控
- `  调试模式: 关闭` - 切换调试信息显示
- `  退出` - 保存并退出程序

**查看股票列表：**
1. 使用方向键选择"查看股票列表"并回车确认
2. 系统显示表格，包含：序号、股票代码、股票名称、持股数量、成本价
3. 显示投资组合总股票数量统计
4. 按 ESC 或 Q 返回主菜单

**添加股票（实时输入）：**
1. 使用方向键选择"添加股票"并回车确认
2. 实时输入股票代码（如：SH601138, AAPL, TSLA 等）
3. 按回车后系统自动获取股票名称和当前价格（3位小数）
4. 实时输入购买成本价，按回车确认
5. 实时输入持股数量，按回车确认完成添加
6. 按 ESC 或 Q 可随时返回主菜单

**删除股票：**
1. 使用方向键选择要删除的股票
2. 按回车确认删除
3. 按 ESC 或 Q 返回主菜单

**开始监控：**
1. 使用方向键选择"开始监控"并回车确认
2. 系统每5秒自动更新一次数据
3. 13列详细展示：股票代码、名称、现价、开盘、最高、最低、成本价、持股数、今日涨幅、当日盈亏、总盈亏、盈亏率、市值
4. 今日涨幅基于开盘价计算：(当前价-开盘价)/开盘价×100%
5. 表格显示盈利为红色，亏损为绿色
6. 按 ESC 或 Q 返回主菜单

**调试模式：**
- 切换后在Bubble Tea模式下调试信息被禁用（保持界面清洁）
- 如需调试，可查看API请求和响应日志

## 股票代码格式

系统支持多种输入格式，会自动转换为正确的API格式：

- **美股：** 直接使用股票代码，如 AAPL, TSLA, MSFT
- **A股：** 支持以下格式
  - `SH601138` 或 `601138` → 自动转换为 `601138.SS`（上海交易所）
  - `SZ000001` 或 `000001` → 自动转换为 `000001.SZ`（深圳交易所）
  - 直接使用标准格式：`601138.SS`, `000001.SZ`
- **港股：** 
  - `HK0700` → 自动转换为 `0700.HK`
  - 直接使用标准格式：`0700.HK`

## 数据来源

程序使用多重数据源确保稳定性：

**主要数据源**（按优先级）：
1. **腾讯财经API** - 中国股票（A股）的主要数据源，提供开盘价、最高价、最低价等完整数据
2. **Finnhub API** - 美股和国际股票的主要数据源
3. **模拟数据** - 当所有API都不可用时提供包含开盘、最高、最低价的完整演示数据

**备用数据源**：
- Alpha Vantage API
- Yahoo Finance API（备用）

**API优势**：
- 多重备份确保数据获取成功率
- 针对不同市场使用最适合的数据源
- 自动故障转移机制

## 文件说明

- `main.go` - 主程序文件
- `portfolio.json` - 投资组合数据文件（自动生成）
- `stock-monitor` - 编译后的可执行文件

## 技术架构

**核心框架：**
- **Bubble Tea**: 现代化终端用户界面框架
- **Go-Pretty**: 专业表格布局库，支持中文字符对齐
- **Golang Text**: 字符编码转换（GBK到UTF-8）

**依赖库：**
```bash
go mod download
# 主要依赖：
# - github.com/charmbracelet/bubbletea v1.3.6
# - github.com/jedib0t/go-pretty/v6 v6.6.8  
# - golang.org/x/text v0.28.0
```

## 系统要求

- Go 1.18 或更高版本
- 网络连接（用于获取股票数据）
- 支持 Windows、macOS、Linux
- 终端支持颜色显示（推荐）

## 故障排除

如果遇到股票数据显示为0或无法获取的情况：

1. **开启调试模式**：选择主菜单选项4（调试信息在Bubble Tea模式下被禁用以保持界面整洁）
2. **检查股票代码格式**：确保使用正确的格式（如SH601138、AAPL等）
3. **检查网络连接**：确保能访问腾讯财经API和Finnhub API
4. **检查股票代码有效性**：确认股票代码存在且格式正确
5. **重试机制**：如遇到API限制，请稍等几分钟后重试

## 常见问题

**界面相关：**
- **中文字符对齐问题**：已使用go-pretty库解决中文字符宽度计算问题
- **颜色显示异常**：确保终端支持ANSI颜色代码
- **键盘响应延迟**：Bubble Tea框架提供实时响应，无需等待确认

**数据获取：**
- **API请求频繁**：系统有5秒更新间隔，避免频繁请求
- **价格显示为0**：可能是股票代码格式错误或网络连接问题
- **中文股票名称乱码**：已实现GBK到UTF-8转换，自动处理编码问题
- **API失败**：系统会自动生成模拟数据用于演示功能

## 更新日志

**v2.2 - 股票监控数据增强**
- ✅ 新增开盘价、最高价、最低价显示
- ✅ 实时计算今日涨幅：基于开盘价的涨跌幅度
- ✅ 监控表格升级为13列详细数据展示
- ✅ 优化表格列顺序：今日涨幅位于当日盈亏左侧
- ✅ 腾讯API和模拟数据支持完整价格数据

**v2.1 - 股票列表查看功能**
- ✅ 新增查看股票列表功能，表格显示股票基本信息
- ✅ 显示序号、股票代码、股票名称、持股数量、成本价
- ✅ 投资组合统计信息展示
- ✅ 优化主菜单结构和用户交互体验

**v2.0 - Bubble Tea重构版本**
- ✅ 集成Bubble Tea框架，实现现代化终端界面
- ✅ 实时键盘响应，无需确认输入
- ✅ 使用go-pretty库解决中文字符对齐问题
- ✅ 添加盈亏颜色显示（红色盈利，绿色亏损）
- ✅ 价格显示精度提升至3位小数
- ✅ 股票间分隔线，提升表格可读性

**v1.0 - 基础版本**
- ✅ 多API数据源（腾讯财经、Finnhub、模拟数据）
- ✅ 中文股票名称GBK编码转换
- ✅ 基础命令行交互界面
- ✅ JSON数据持久化存储

## 注意事项

1. **现代化体验**：基于Bubble Tea框架的流畅交互，支持实时键盘监控
2. **数据精度**：价格显示精确到3位小数，满足专业需求
3. **中文支持**：完美处理中文字符宽度和编码转换问题
4. **颜色显示**：盈利亏损用颜色区分，一目了然
5. **自动保存**：投资组合数据实时保存，程序重启后保留
6. **跨平台**：支持 Windows、macOS、Linux 系统
7. **建议使用时间**：股市开盘时间获得最准确的实时数据