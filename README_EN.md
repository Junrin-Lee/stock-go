# Stock Monitor

> ğŸ¤– **AI Generated Repository**: This entire project was generated by AI, including code architecture, implementation, and documentation.
---

ğŸ“– **Documentation**: [English](README_EN.md) | [ä¸­æ–‡](README.md)

## ğŸŒŸ Project Overview

Stock Monitor is a command-line terminal stock monitoring tool designed for investors.

### ğŸ¯ Core Features

- **ğŸ”„ Real-time Monitoring** - 5-second interval automatic price refresh, capture every trading moment
- **ğŸ“Š Professional Analysis** - 13-column detailed data display including OHLC, P&L analysis, and market value statistics
- **ğŸ¨ Smart Display** - Professional stock software color standards: red for gains, green for losses, white for neutral
- **ğŸ’¼ Portfolio Management** - Complete position management with add, edit, and delete stock operations
- **ğŸŒ Global Markets** - Support for A-shares, US stocks, Hong Kong stocks and other major market code formats
- **ğŸ’¾ Data Persistence** - Local JSON storage, investment portfolio data is never lost

## âœ¨ Features

### ğŸ“± Modern Interactive Interface
- Responsive terminal UI built with Bubble Tea framework
- Real-time keyboard response without waiting for confirmation
- Smooth state transitions and menu navigation
- Support for arrow keys, WASD, and Vim-style shortcuts

### ğŸ“ˆ Real-time Data Monitoring
- **Auto Updates**: Refresh stock price data every 5 seconds
- **Multi-dimensional Data**: Current price, open price, high price, low price, previous close
- **Change Analysis**: Precise change percentage based on previous close
- **P&L Statistics**: Real-time calculation of daily P&L, total P&L, and P&L rate

### ğŸ’¼ Portfolio Management
- **Stock Search**: Support code or Chinese name search for stock information
- **Position Management**: Add, edit, delete stocks in investment portfolio
- **Cost Tracking**: Record purchase cost price and share quantity
- **Auto Calculation**: Real-time calculation of market value, P&L and other key metrics

### ğŸ¨ Professional Data Display
- Professional table layout using go-pretty library
- Perfect Chinese character width alignment
- Smart color system: red (profit/gain), green (loss/decline), white (neutral)
- 13-column detailed data display covering all key investment indicators

## ğŸš€ Quick Start

### ğŸ“¦ Requirements

- **Go Version**: 1.18 or higher
- **Network Connection**: For fetching real-time stock data
- **System Support**: Windows, macOS, Linux
- **Terminal**: Color display support (recommended)

### âš¡ Installation & Setup

#### 1ï¸âƒ£ Clone Repository
```bash
git clone <repository-url>
cd stock-go
```

#### 2ï¸âƒ£ Install Dependencies
```bash
go mod download
```

#### 3ï¸âƒ£ Build Program
```bash
go build -o stock-go main.go
```

#### 4ï¸âƒ£ Run Program
```bash
./stock-go
```

### ğŸ® User Guide

#### âŒ¨ï¸ Keyboard Shortcuts
- **Navigation**: `â†‘â†“` Arrow keys or `W/S` or `J/K` (Vim style)
- **Confirm**: `Enter` or `Space` key
- **Return**: `ESC` or `Q` key
- **Force Quit**: `Ctrl+C`

#### ğŸ  Main Menu Navigation
```
=== Stock Monitor System ===

â–º Stock List        # Enter real-time monitoring
  Stock Search      # Search stock information
  Add Stock         # Add new investment
  Edit Stock        # Edit position info
  Remove Stock      # Remove investment
  Debug Mode: Off   # Toggle debug info
  Exit             # Save and exit
```

#### ğŸ’¡ Smart Startup
- **With Portfolio Data**: Program automatically enters monitoring mode
- **No Portfolio Data**: Shows main menu, guides user to add stocks

## ğŸ“Š Features Overview

### ğŸ“ˆ Real-time Monitoring Interface

Once in monitoring mode, the system displays professional stock data tables:

=== Real-time Stock Monitor ===
Update Time(5s): 2024-01-01 15:30:25

| Code | Name | Price | PrevClose | Open | High | Low | Cost | Quantity | Today% | DailyP&L | TotalP&L | P&LRate | Value |
|------|------|-------|-----------|------|------|-----|------|----------|--------|----------|----------|---------|-------|
| SH601138 | Industrial | 61.900 | 59.040 | 58.880 | 63.100 | 58.030 | 47.963 | 400 | +4.84% | +1144.00 | +5574.80 | +29.19% | 24760.00 |

ESC, Q or M to return to main menu

**Table Features**:
- **Smart Colors**: Red for profit/gains, green for loss/declines, white for neutral
- **Real-time Updates**: Automatically refresh latest stock data every 5 seconds
- **Precise Calculations**: All P&L data calculated accurately based on real-time prices
- **Summary Statistics**: Bottom shows overall portfolio P&L status

### ğŸ” Stock Search Function

Support multiple search methods:

```
=== Stock Search ===

Enter stock code or name: Apple_

Supported formats:
â€¢ Chinese names: è´µå·èŒ…å°, è‹¹æœ, è…¾è®¯, é˜¿é‡Œå·´å·´, etc.
â€¢ Chinese stocks: SH601138, 000001, SZ000002, etc.
â€¢ US stocks: AAPL, TSLA, MSFT, etc.
â€¢ Hong Kong stocks: HK00700, etc.
```

### â• Add Stock Workflow

**Step 1**: Enter stock code
```
=== Add Stock ===

Enter stock code: SH601138_
Supported formats: SH601138, 000001, AAPL, etc.
```

**Step 2**: Confirm stock information
```
Stock Code: SH601138
Stock Name: Industrial Fulian
Current Price: 61.900

Enter cost price: 47.963_
```

**Step 3**: Enter share quantity
```
Stock Code: SH601138
Stock Name: Industrial Fulian
Current Price: 61.900
Cost Price: 47.963

Enter quantity: 400_
```

### âœï¸ Edit Position Information

Select stock to modify, system guides through cost price and quantity updates:

```
=== Edit Stock ===

Select stock to edit:

â–º 1. Industrial Fulian (SH601138) - Cost: 47.963, Quantity: 400
  2. Hang Seng Tech ETF (SH513180) - Cost: 0.510, Quantity: 10000

Use arrow keys to select, Enter to confirm, ESC or Q to return
```

## ğŸŒ Supported Stock Markets

### ğŸ“ Stock Code Formats

System intelligently recognizes and supports global mainstream stock markets:

| Market | Supported Format | Examples | Auto Conversion |
|--------|------------------|----------|----------------|
| ğŸ‡¨ğŸ‡³ **A-Share Shanghai** | `SH + 6 digits` or `6 digits` | `SH601138`, `601138` | `â†’ 601138.SS` |
| ğŸ‡¨ğŸ‡³ **A-Share Shenzhen** | `SZ + 6 digits` or `6 digits` | `SZ000001`, `000001` | `â†’ 000001.SZ` |
| ğŸ‡ºğŸ‡¸ **US Stocks** | Direct stock codes | `AAPL`, `TSLA`, `MSFT` | No conversion needed |
| ğŸ‡­ğŸ‡° **Hong Kong Stocks** | `HK + 5 digits` or standard format | `HK00700`, `0700.HK` | `â†’ 0700.HK` |

### ğŸ’¡ Chinese Name Search

System supports using Chinese names to search stocks:

```
Chinese Input â†’ Auto Match
Apple        â†’ AAPL
Tesla        â†’ TSLA  
Tencent      â†’ 00700.HK
Maotai       â†’ SH600519
```

## ğŸ“¡ Data Sources & APIs

### ğŸ¯ Multi-tier Data Strategy

System adopts multi-source + automatic fault tolerance mechanism to ensure data acquisition reliability:

```
Stock Code â†’ [Chinese Stock?] â†’ [Tencent API] â†’ [Success?] â†’ Return Data
                    â”‚              â”‚           â”‚
                    â†“              â†“           â†“ Failed
                [Finnhub API] â†’ [Success?] â†’ [Mock Data] â†’ Return Data
```

### ğŸ“Š Data Source Details

| Priority | API Name | Applicable Markets | Data Completeness | Update Frequency |
|:--------:|----------|-------------------|-------------------|------------------|
| ğŸ¥‡ **1** | **Tencent API** | ğŸ‡¨ğŸ‡³ A-Share Markets | Complete (OHLC) | Real-time |
| ğŸ¥ˆ **2** | **Finnhub API** | ğŸ‡ºğŸ‡¸ US / ğŸ‡­ğŸ‡° HK Markets | Basic Data | Real-time |
| ğŸ¥‰ **3** | **Mock Data** | All Markets | Complete Demo Data | Real-time Generated |

### ğŸ”„ Fault Tolerance

- **Auto Retry**: Automatically try next data source when API fails
- **Smart Selection**: Choose optimal data source based on stock type
- **Fallback Guarantee**: Ultimately provide mock data to ensure program availability

## ğŸ“ Project Structure

```
stock-go/
â”‚
â”œâ”€â”€ main.go              # ğŸš€ Main program file (contains all logic)
â”œâ”€â”€ go.mod               # ğŸ“¦ Go module dependencies
â”œâ”€â”€ go.sum               # ğŸ”’ Dependency version lock file
â”‚
â”œâ”€â”€ portfolio.json       # ğŸ“Š Portfolio data (auto-generated)
â”œâ”€â”€ stock-go             # âš™ï¸ Compiled executable
â”‚
â”œâ”€â”€ README.md            # ğŸ“ Chinese documentation
â””â”€â”€ README_EN.md         # ğŸ“ English documentation
```

### ğŸ’¾ Data Storage

**portfolio.json** example:
```json
{
  "stocks": [
    {
      "code": "SH601138",
      "name": "Industrial Fulian",
      "cost_price": 47.963,
      "quantity": 400,
      "price": 61.9,
      "change": 2.86,
      "change_percent": 4.84
    }
  ]
}
```

## ğŸ­ Technical Architecture

### ğŸ”§ Core Technology Stack

```
ğŸ–¥ï¸ User Interface â† Bubble Tea Framework
     â”‚
     â”œâ”€ ğŸ“‹ Data Display â† Go-Pretty Table Library
     â”‚
     â”œâ”€ ğŸ“¡ Data Fetching â† HTTP Client + Encoding Conversion
     â”‚
     â””â”€ ğŸ’¾ Data Storage â† JSON Files
```

### ğŸ“¦ Dependency Details

| Component | Version | Function | Advantages |
|-----------|---------|----------|------------|
| **Bubble Tea** | `v1.3.6` | Terminal UI Framework | â€¢ Responsive interaction<br>â€¢ Real-time event handling<br>â€¢ Modern experience |
| **Go-Pretty** | `v6.6.8` | Table Layout Library | â€¢ Chinese character alignment<br>â€¢ Rich style support<br>â€¢ Out-of-the-box |
| **Golang Text** | `v0.28.0` | Encoding Conversion | â€¢ GBK to UTF-8<br>â€¢ Multi-language support<br>â€¢ Official library |

### âš™ï¸ Install Dependencies

```bash
# Auto download all dependencies
go mod download

# Or manually install core dependencies
go get github.com/charmbracelet/bubbletea@v1.3.6
go get github.com/jedib0t/go-pretty/v6@v6.6.8
go get golang.org/x/text@v0.28.0
```

## System Requirements

- Go 1.18 or higher
- Internet connection (for fetching stock data)
- Windows, macOS, Linux support
- Color-capable terminal (recommended)

## ğŸ”§ Troubleshooting

### âš ï¸ Common Issues & Solutions

| Issue | Possible Causes | Solutions |
|-------|----------------|----------|
| ğŸš« Stock data shows 0 | â€¢ Wrong stock code<br>â€¢ Network issues<br>â€¢ API limits | â€¢ Check code format<br>â€¢ Check network connection<br>â€¢ Retry later |
| ğŸ¨ Color display issues | â€¢ Terminal doesn't support colors<br>â€¢ ANSI code issues | â€¢ Use color-capable terminal<br>â€¢ Check terminal settings |
| ğŸ”¤ Chinese text garbled | â€¢ Encoding issues<br>â€¢ Font not supported | â€¢ System handles automatically<br>â€¢ Check terminal font |
| â±ï¸ Response delay | â€¢ Slow network connection<br>â€¢ Slow API response | â€¢ Check network status<br>â€¢ Switch network environment |

### ğŸ” Debug Mode

Enable "Debug Mode" in main menu to get more detailed error information:

```
=== Stock Monitor System ===

  Stock List
  Stock Search
  Add Stock
  Edit Stock
  Remove Stock
â–º Debug Mode: On    # Click to toggle
  Exit
```

### ğŸ“ Getting Help

If you encounter issues you can't solve, please provide:

- âš™ï¸ Operating system version
- ğŸš€ Go language version
- ğŸ“„ Error log screenshots
- ğŸŒ Network environment description
- ğŸ’° Related stock codes

## ğŸŒŸ Special Features

### ğŸ¨ Smart Color System

System adopts professional stock software color standards:

- ğŸ”´ **Red**: Profit/gain values (> 0.001)
- ğŸŸ¢ **Green**: Loss/decline values (< -0.001)
- âšª **White**: Neutral values (â‰ˆ 0), such as 0% change, $0 P&L

### ğŸ•°ï¸ Real-time Update Mechanism

- **Update Frequency**: Auto refresh every 5 seconds
- **Smart Caching**: Avoid frequent API requests
- **Fault Tolerance**: Auto fallback when API fails

### ğŸ“Š Precise Calculations

- **Today's Change**: Based on previous close `(Current Price - Previous Close) / Previous Close Ã— 100%`
- **P&L Statistics**: Real-time calculation of daily P&L, total P&L, P&L rate
- **Market Value**: Current Price Ã— Share Quantity

## ğŸ“ˆ Version History

### ğŸ‰ v2.5 - Interface Logic Optimization ğŸ†•

**New Features**:
- âœ¨ **Smart Startup**: Auto-enter monitoring mode when portfolio data exists
- ğŸ¯ **One-click Access**: Main menu "Stock List" directly enters real-time monitoring
- âª **Multi-key Return**: Support ESC, Q, M keys for multiple return methods

**Experience Improvements**:
- ğŸ§¹ **Streamlined Menu**: Remove duplicate functions, cleaner menu
- ğŸ’¬ **Message Management**: Fix persistent success message issues

---

### ğŸ“… Historical Versions

<details>
<summary>ğŸ”½ Click to view more version info</summary>

**v2.4 - Stock Editing & Enhanced Stock List View**
- âœ… New stock editing feature: Modify cost price and quantity of existing stocks through interactive interface
- âœ… Enhanced stock list view: Real-time price fetching with display of today's change, daily P&L, total P&L, P&L rate, and market value
- âœ… Unified color display logic: Stock list view uses same color scheme as monitoring interface
- âœ… Portfolio summary: Stock list view shows overall P&L statistics at bottom
- âœ… Interaction optimization: Pre-fill current values when editing stocks for better user experience

**v2.3 - Smart Color Display System**
- âœ… Smart color judgment: Each value determines color based on its own value
- âœ… White neutral display: Zero values shown in white (e.g., 0% today's change, $0 daily P&L)
- âœ… Precise floating-point comparison: Uses epsilon values to avoid precision issues
- âœ… Professional stock software color standards: Red up, green down, white flat

**v2.2 - Stock Monitoring Data Enhancement**
- âœ… Added open price, high price, low price display
- âœ… Real-time today's change calculation: based on previous close fluctuation
- âœ… Upgraded monitoring table to 13-column detailed data display
- âœ… Optimized table column order: Today's change positioned left of daily P&L
- âœ… Tencent API and mock data support complete price data

**v2.1 - Stock List View Feature**
- âœ… Added stock list view function with table display of stock basic information
- âœ… Display serial number, stock code, stock name, quantity, cost price
- âœ… Portfolio statistics information display
- âœ… Optimized main menu structure and user interaction experience

**v2.0 - Bubble Tea Refactored Version**
- âœ… Integrated Bubble Tea framework for modern terminal interface
- âœ… Real-time keyboard response without confirmation prompts
- âœ… Used go-pretty library to solve Chinese character alignment issues
- âœ… Added profit/loss color display (red for profit, green for loss)
- âœ… Enhanced price display precision to 3 decimal places
- âœ… Stock separators for improved table readability

**v1.0 - Base Version**
- âœ… Multi-API data sources (Tencent Finance, Finnhub, Mock Data)
- âœ… Chinese stock name GBK encoding conversion
- âœ… Basic command-line interactive interface
- âœ… JSON data persistence storage

</details>

## ğŸ“ Usage Notes

### âœ¨ Product Highlights

- ğŸ® **Modern Experience**: Smooth terminal interface built with Bubble Tea framework
- ğŸ” **Precise Data**: 3 decimal precision, professional-grade data display
- ğŸŒ **Global Support**: Complete coverage of A-shares, US stocks, Hong Kong stocks
- ğŸ’¾ **Data Persistence**: Local JSON storage, never lose data
- ğŸŒˆ **Smart Display**: Professional stock software color scheme

### ğŸ“… Optimal Usage Times

| Time Period | Market Status | Data Quality |
|-------------|---------------|-------------|
| **09:30-15:00** | ğŸŸ¢ A-Share Trading Hours | â­â­â­â­â­ Real-time Data |
| **21:30-04:00** | ğŸ‡ºğŸ‡¸ US Trading Hours | â­â­â­â­â­ Real-time Data |
| **Non-trading Hours** | ğŸ”´ Market Closed | â­â­â­ Previous Close Price |

### ğŸš€ Quick Start Guide

1. **First Time Use**: Enter main menu directly, add some stocks first
2. **After Adding**: Program auto-enters monitoring mode on restart
3. **Daily Use**: View real-time data directly, adjust positions when needed

---

> ğŸ“ **Friendly Reminder**: Please use during trading hours for most accurate data. Non-trading hours display the last trading price.