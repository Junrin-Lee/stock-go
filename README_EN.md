# Stock Monitor System | è‚¡ç¥¨ç›‘æŽ§ç³»ç»Ÿ

> ðŸ¤– **AI Generated Repository**: This entire project was generated by AI, including code architecture, implementation, and documentation.

ðŸ“– **Language**: [ä¸­æ–‡](README.md) | [English](README_EN.md)

A modern command-line stock monitoring tool built with Go, featuring a smooth terminal interface powered by the Bubble Tea framework.

## Features

âœ… **Modern Interactive Interface**
- Responsive terminal interface built with Bubble Tea framework
- Real-time keyboard monitoring without confirmation prompts
- Smooth menu navigation and state transitions
- Support for arrow keys, WASD, and vim-style navigation

âœ… **Portfolio Management**
- View stock list: Table display of monitored stock basic information
- Add/remove stocks to/from portfolio
- Automatic stock name retrieval - just input code, cost, and quantity
- 3-decimal precision for price display
- Persistent local data storage

âœ… **Real-time Monitoring**  
- 5-second interval real-time price updates
- Display current price, daily change, and percentage change
- Calculate daily profit/loss and total profit/loss
- Show profit rate and market value

âœ… **Professional Table Display**
- Professional table layout using go-pretty library
- Perfect Chinese character width alignment
- Profit numbers in red, loss numbers in green
- Stock separators for improved readability

## Usage

### 1. Build the Program
```bash
go build -o stock-monitor main.go
```

### 2. Run the Program
```bash
./stock-monitor
```

### 3. Operating Instructions

**Keyboard Controls**:
- `â†‘â†“ Arrow Keys` or `W/S/J/K` - Navigate menu items
- `Enter` or `Space` - Confirm selection
- `ESC` or `Q` - Exit current interface/program
- `Ctrl+C` - Force quit program

**Main Menu Options:**
- `â–º View Stock List` - View monitored stock basic information
- `  Add Stock` - Add new stock to portfolio
- `  Remove Stock` - Remove stock from portfolio  
- `  Start Monitoring` - Launch real-time monitoring
- `  Debug Mode: Off` - Toggle debug information display
- `  Exit` - Save and exit program

**View Stock List:**
1. Use arrow keys to select "View Stock List" and press Enter
2. System displays table containing: Serial Number, Stock Code, Stock Name, Quantity, Cost Price
3. Shows portfolio total stock count statistics
4. Press ESC or Q to return to main menu

**Add Stock (Real-time Input):**
1. Use arrow keys to select "Add Stock" and press Enter
2. Type stock code in real-time (e.g., SH601138, AAPL, TSLA)
3. Press Enter to automatically fetch stock name and current price (3 decimals)
4. Type purchase cost price in real-time, press Enter to confirm
5. Type quantity in real-time, press Enter to complete addition
6. Press ESC or Q to return to main menu anytime

**Remove Stock:**
1. Use arrow keys to select stock to remove
2. Press Enter to confirm deletion
3. Press ESC or Q to return to main menu

**Start Monitoring:**
1. Use arrow keys to select "Start Monitoring" and press Enter
2. System updates data every 5 seconds automatically
3. Table displays profits in red, losses in green
4. Press ESC or Q to return to main menu

**Debug Mode:**
- Debug information is disabled in Bubble Tea mode (for clean interface)
- For debugging, check API request and response logs

## Stock Code Formats

The system supports multiple input formats and automatically converts to correct API format:

- **US Stocks:** Direct stock codes like AAPL, TSLA, MSFT
- **A-Shares:** Support multiple formats
  - `SH601138` or `601138` â†’ Auto-convert to `601138.SS` (Shanghai Stock Exchange)
  - `SZ000001` or `000001` â†’ Auto-convert to `000001.SZ` (Shenzhen Stock Exchange)
  - Direct standard format: `601138.SS`, `000001.SZ`
- **Hong Kong Stocks:** 
  - `HK0700` â†’ Auto-convert to `0700.HK`
  - Direct standard format: `0700.HK`

## Data Sources

Multi-source data strategy ensures reliability:

**Primary Sources** (by priority):
1. **Tencent Finance API** - Primary source for Chinese stocks (A-shares), fast and stable
2. **Finnhub API** - Primary source for US stocks and international markets
3. **Mock Data** - Provides demo data when all APIs are unavailable

**Backup Sources**:
- Alpha Vantage API
- Yahoo Finance API (backup)

**API Advantages**:
- Multiple backups ensure high data acquisition success rate
- Use most suitable data source for different markets
- Automatic failover mechanism

## File Description

- `main.go` - Main program file
- `portfolio.json` - Portfolio data file (auto-generated)
- `stock-monitor` - Compiled executable file

## Technical Architecture

**Core Frameworks:**
- **Bubble Tea**: Modern terminal user interface framework
- **Go-Pretty**: Professional table layout library with Chinese character alignment support
- **Golang Text**: Character encoding conversion (GBK to UTF-8)

**Dependencies:**
```bash
go mod download
# Main dependencies:
# - github.com/charmbracelet/bubbletea v1.3.6
# - github.com/jedib0t/go-pretty/v6 v6.6.8  
# - golang.org/x/text v0.28.0
```

## System Requirements

- Go 1.18 or higher
- Internet connection (for fetching stock data)
- Windows, macOS, Linux support
- Color-capable terminal (recommended)

## Troubleshooting

If encountering stock data showing as 0 or unable to fetch:

1. **Enable debug mode**: Select main menu option 4 (debug info disabled in Bubble Tea mode for clean interface)
2. **Check stock code format**: Ensure correct format (like SH601138, AAPL, etc.)
3. **Check network connection**: Ensure access to Tencent Finance API and Finnhub API
4. **Verify stock code validity**: Confirm stock code exists and format is correct
5. **Retry mechanism**: If encountering API limits, wait a few minutes and retry

## Common Issues

**Interface Related:**
- **Chinese character alignment issues**: Solved using go-pretty library for proper Chinese character width calculation
- **Color display problems**: Ensure terminal supports ANSI color codes
- **Keyboard response delay**: Bubble Tea framework provides real-time response without confirmation waiting

**Data Fetching:**
- **Frequent API requests**: System has 5-second update interval to avoid frequent requests
- **Price showing as 0**: May be due to incorrect stock code format or network connection issues
- **Chinese stock name garbled text**: Implemented GBK to UTF-8 conversion, automatically handles encoding issues
- **API failures**: System automatically generates mock data for demonstration

## Changelog

**v2.1 - Stock List View Feature**
- âœ… Added stock list view function with table display of stock basic information
- âœ… Display serial number, stock code, stock name, quantity, cost price
- âœ… Portfolio statistics information display
- âœ… Optimized main menu structure and user interaction experience

**v2.0 - Bubble Tea Refactored Version**
- âœ… Integrated Bubble Tea framework for modern terminal interface
- âœ… Real-time keyboard response without confirmation prompts
- âœ… Used go-pretty library to solve Chinese character alignment issues
- âœ… Added profit/loss color display (red for profit, green for loss)
- âœ… Enhanced price display precision to 3 decimal places
- âœ… Stock separators for improved table readability

**v1.0 - Base Version**
- âœ… Multi-API data sources (Tencent Finance, Finnhub, Mock Data)
- âœ… Chinese stock name GBK encoding conversion
- âœ… Basic command-line interactive interface
- âœ… JSON data persistence storage

## Notes

1. **Modern Experience**: Smooth interaction based on Bubble Tea framework with real-time keyboard monitoring
2. **Data Precision**: Price display accurate to 3 decimal places for professional needs
3. **Chinese Support**: Perfect handling of Chinese character width and encoding conversion
4. **Color Display**: Profit/loss distinguished by colors for clear visualization
5. **Auto-save**: Portfolio data saved in real-time, retained after program restart
6. **Cross-platform**: Supports Windows, macOS, Linux systems
7. **Recommended Usage Time**: Use during market hours for most accurate real-time data