# Stock Monitor

> 🤖 **AI Generated Repository**: This entire project was generated by AI, including code architecture, implementation, and documentation.
---

📖 **Documentation**: [English](README_EN.md) | [中文](README.md)

## 🌟 Project Overview

Stock Monitor is a command-line terminal stock monitoring tool designed for investors.

### 🎯 Core Features

- **🔄 Real-time Monitoring** - 5-second interval automatic price refresh, capture every trading moment
- **📊 Professional Analysis** - 14-column detailed data display including OHLC, today's P&L, position P&L, P&L rate analysis, and market value statistics
- **🎨 Smart Display** - Professional stock software color standards: red for gains, green for losses, white for neutral
- **💼 Portfolio Management** - Complete position management with add, edit, and delete stock operations
- **🌐 Global Markets** - Support for A-shares, US stocks, Hong Kong stocks and other major market code formats
- **💾 Data Persistence** - Local JSON storage, portfolio data never lost

## ✨ Features

### 📱 Modern Interactive Interface
- Responsive terminal UI built with Bubble Tea framework
- Real-time keyboard response without waiting for confirmation
- Smooth state transitions and menu navigation
- Support for arrow keys, WASD, and Vim-style shortcuts

### 📈 Real-time Data Monitoring
- **Auto Updates**: Refresh stock price data every 5 seconds
- **Multi-dimensional Data**: Current price, open price, high price, low price, previous close
- **Change Analysis**: Precise change percentage based on previous close
- **P&L Statistics**: Real-time calculation of today's P&L, position P&L, and P&L rate

### 💼 Portfolio Management
- **Stock Search**: Support stock code or Chinese name search ⭐ v4.0 Perfect Fix
- **Position Management**: Add, edit, delete stocks in investment portfolio
- **Cost Tracking**: Record purchase cost price and share quantity
- **Auto Calculation**: Real-time calculation of market value, P&L and other key metrics

### 🎨 Professional Data Display
- Professional table layout using go-pretty library
- Perfect Chinese character width alignment
- Smart color system: red (profit/gain), green (loss/decline), white (neutral)
- 14-column detailed data display covering all key investment indicators

## 🚀 Quick Start

### 📦 Requirements

- **Go Version**: 1.18 or higher
- **Network Connection**: For fetching real-time stock data
- **System Support**: Windows, macOS, Linux
- **Terminal**: Color display support (recommended)

### ⚡ Installation & Setup

#### 1️⃣ Clone Repository
```bash
git clone <repository-url>
cd stock-go
```

#### 2️⃣ Install Dependencies
```bash
go mod download
```

#### 3️⃣ Build Program
```bash
go build -o cmd/stock-monitor main.go
```

#### 4️⃣ Run Program
```bash
./cmd/stock-monitor
```

### 🎮 User Guide

#### ⌨️ Keyboard Shortcuts
- **Navigation**: `↑↓` Arrow keys or `W/S` or `J/K` (Vim style)
- **Confirm**: `Enter` or `Space` key
- **Return**: `ESC` or `Q` key
- **Force Quit**: `Ctrl+C`
- **Portfolio Specific**:
  - `E` key: Edit selected stock
  - `D` key: Delete selected stock
  - `S` key: Enter sort settings menu ⭐ v4.5 New
- **Watchlist Specific**:
  - `A` key: Add stock to watchlist
  - `D` key: Delete selected stock
  - `S` key: Enter sort settings menu ⭐ v4.5 New
  - `T` key: Add/modify tag for selected stock ⭐ v4.4 New
  - `G` key: Enter group view mode by tags ⭐ v4.4 New
  - `C` key: Clear tag filter, show all stocks ⭐ v4.4 New
- **Sort Menu Specific** ⭐ v4.5 New:
  - `↑↓` keys: Select sort field
  - `Enter` key: Apply sort or toggle ascending/descending
  - `C` key: Clear current sort, restore original data order
  - `ESC/Q` keys: Return to list page

#### 🏠 Main Menu Navigation
```
=== Stock Monitor System ===

► Portfolio         # Enter real-time monitoring interface (E key edit, D key delete)
  Watchlist         # View watchlist ⭐ New Feature
  Stock Search      # Search stock information and add stocks
  Debug Mode: Off   # Toggle debug information
  Language: English # Language selection
  Exit             # Save and exit program
```

#### 💡 Smart Startup
- **With Portfolio Data**: Program automatically enters monitoring mode
- **No Portfolio Data**: Shows main menu, guides user to add stocks

## ⚙️ Configuration File

### 📄 Configuration Guide

The system provides a `config.yaml` configuration file that users can edit to customize system startup parameters:

#### 🔧 Configuration Options

| Setting | Default | Description | Possible Values |
|---------|---------|-------------|-----------------|
| `system.language` | `"en"` | Default system language | `"zh"` (Chinese), `"en"` (English) |
| `system.auto_start` | `true` | Auto enter monitoring mode when data exists | `true`, `false` |
| `system.startup_module` | `"portfolio"` | Default module to enter on startup ⭐ v4.1 New | `"portfolio"` (holdings), `"watchlist"` (favorites) |
| `system.debug_mode` | `false` | Debug mode switch | `true`, `false` |
| `display.color_scheme` | `"professional"` | Color scheme | `"professional"`, `"simple"` |
| `display.decimal_places` | `3` | Price decimal places | `1-4` |
| `display.table_style` | `"light"` | Table style | `"light"`, `"bold"`, `"simple"` |
| `update.refresh_interval` | `5` | Data refresh interval (seconds) | Any positive integer |
| `update.auto_update` | `true` | Enable auto update | `true`, `false` |

#### 💡 Configuration Features

- **Auto Creation**: Default configuration file is automatically created on first run
- **Real-time Save**: Settings changed through the interface (like language, debug mode) are automatically saved
- **Error Handling**: Automatically uses default configuration when config file has errors
- **Bilingual Comments**: Configuration file includes both Chinese and English comments

#### 🛠️ Manual Configuration Editing

You can directly edit the `config.yaml` file to modify settings:

```bash
# Edit config file with any text editor
nano config.yaml
# or
vim config.yaml
```

**Note**: Restart the program after modifying the configuration file for changes to take effect.

## 📊 Feature Details

### ⭐ Watchlist Feature (New)

The watchlist module is a stock watch list that allows you to quickly view real-time data of stocks of interest without adding them to your investment portfolio.

#### 🎯 Key Features
- **Quick Watch**: One-click addition to watchlist after stock search
- **Real-time Refresh**: Automatically update watchlist real-time market data every 5 seconds ⭐ New
- **Complete Data**: Display detailed market data for watchlist stocks (including tags, turnover rate and volume)
- **Tag Grouping**: Support adding custom tags to stocks and view by tag groups ⭐ v4.4 New
- **Flexible Management**: Support adding, deleting, tagging, and group filtering of watchlist stocks
- **Independent Storage**: Watchlist and portfolio are managed separately

#### 📱 Usage Workflow

**1. Add to Watchlist**
```
Stock Search → Enter stock code/name → View details → Press "1" to add to watchlist → Auto-enter watchlist page
```

**2. Add to Portfolio**
```
Stock Search → Enter stock code/name → View details → Press "2" to add to portfolio → Enter cost and quantity → Auto-enter portfolio monitoring page
```

**3. View Watchlist**
```
Main Menu → Watchlist → Real-time view of all watchlist stocks (auto-refresh every 5 seconds)
```

**4. Delete from Watchlist**
```
Watchlist page → Press "D" key → Select stock to delete → Confirm deletion
```

**5. Quick Search New Stock** ⭐ v4.1 New
```
Watchlist page → Press "A" key → Direct jump to stock search page
```

**6. Stock Tag Management** ⭐ v4.4 New
```
Watchlist page → Press "T" key → Add tag to selected stock (supports Chinese) → Press Enter to confirm
```

**7. Group View Function** ⭐ v4.4 New
```
Watchlist page → Press "G" key → Select tag to view → Display only stocks under that tag
```

**8. Clear Tag Filter** ⭐ v4.4 New
```
In tag filter state → Press "C" key → Clear filter, display all stocks
```

#### 🔄 New Search Result Actions

After searching for stocks, two operation options are now provided:
- **Press "1" key**: Add to watchlist (watch only, no investment) → Auto-redirect to watchlist page
- **Press "2" key**: Add to portfolio (requires cost price and quantity input) → Auto-redirect to portfolio monitoring page after completion

## 📊 Features Overview

### 📈 Real-time Monitoring Interface

Once in monitoring mode, the system displays professional stock data tables:

=== Real-time Stock Monitor ===
Update Time(5s): 2024-01-01 15:30:25

| Code | Name | PrevClose | Price | Cost | Open | High | Low | Quantity | Today% | TodayP&L | PositionP&L | P&LRate | Value |
|------|------|-----------|-------|------|------|------|------|----------|--------|----------|-------------|---------|-------|
| SH601138 | Industrial | 59.040 | 61.900 | 47.963 | 58.880 | 63.100 | 58.030 | 400 | +4.84% | +1144.00 | +5574.80 | +29.19% | 24760.00 |

ESC, Q or M to return to main menu

**Table Features**:
- **Smart Colors**: Red for profit/gains, green for loss/declines, white for neutral
- **Real-time Updates**: Automatically refresh latest stock data every 5 seconds
- **Precise Calculations**: All P&L data calculated accurately based on real-time prices
- **Summary Statistics**: Bottom shows overall portfolio P&L status

### 🔍 Stock Search Function

Support multiple search methods, **v4.0 version perfectly fixed Chinese stock name search**:

```
=== Stock Search ===

Enter stock code or name: 工业富联_

Supported formats:
• Chinese names: 工业富联, 恒生科技, 比亚迪, 腾讯, etc. ⭐ v4.0 Perfect Fix, 100% Available
• Chinese stocks: SH601138, 000001, SZ000002, etc.
• US stocks: AAPL, TSLA, MSFT, etc.
• Hong Kong stocks: HK00700, etc.

✅ v4.0 Update: Chinese search completely fixed, success rate nearly 100%!
```

### ➕ Add Stock Workflow

**Note**: Adding stocks is now completed through the "Stock Search" function. There is no longer an independent "Add Stock" menu.

**Step 1**: Search for stocks via Stock Search
```
=== Stock Search ===

Enter stock code or name: SH601138_
Supported formats: SH601138, 000001, AAPL, etc.
```

**Step 2**: Choose to add to portfolio
```
Stock Code: SH601138
Stock Name: Industrial Foxconn
Current Price: 61.900

Press "1" to add to watchlist, press "2" to add to portfolio
```

**Step 3**: Enter cost price and quantity (when choosing to add to portfolio)
```
Stock Code: SH601138
Stock Name: Industrial Foxconn
Current Price: 61.900

Enter cost price: 47.963_
Enter quantity: 400_
```

### ✏️ Edit Position Information

**Note**: Stock editing function has been integrated into the portfolio list. Press **E key** on the portfolio monitoring page to edit stocks.

Edit workflow:
```
Portfolio page → Press E key → Select stock to edit → Enter new cost price and quantity → Auto-return to portfolio
```

Edit interface example:
```
=== Edit Stock ===

Select stock to edit:

► 1. Industrial Foxconn (SH601138) - Cost: 47.963, Quantity: 400
  2. Hang Seng Tech Index ETF (SH513180) - Cost: 0.510, Quantity: 10000

Use arrow keys to select, Enter to confirm, ESC or Q to return
```

### 🗑️ Delete Position Information

**Note**: Stock deletion function has been integrated into the portfolio list. Press **D key** on the portfolio monitoring page to delete stocks.

Delete workflow:
```
Portfolio page → Press D key → Select stock to delete → Confirm deletion → Auto-return to portfolio
```

Delete interface example:
```
=== Delete Stock ===

Select stock to delete:

► 1. Industrial Foxconn (SH601138)
  2. Hang Seng Tech Index ETF (SH513180)

Use arrow keys to select, Enter to confirm, ESC or Q to return
```

## 🌐 Supported Stock Markets

### 📍 Stock Code Formats

System intelligently recognizes and supports global mainstream stock markets:

| Market | Supported Format | Examples | Auto Conversion |
|--------|------------------|----------|----------------|
| 🇨🇳 **A-Share Shanghai** | `SH + 6 digits` or `6 digits` | `SH601138`, `601138` | `→ 601138.SS` |
| 🇨🇳 **A-Share Shenzhen** | `SZ + 6 digits` or `6 digits` | `SZ000001`, `000001` | `→ 000001.SZ` |
| 🇺🇸 **US Stocks** | Direct stock codes | `AAPL`, `TSLA`, `MSFT` | No conversion needed |
| 🇭🇰 **Hong Kong Stocks** | `HK + 5 digits` or standard format | `HK00700`, `0700.HK` | `→ 0700.HK` |

### 💡 Chinese Name Search

System supports using Chinese names to search stocks:

```
Chinese Input → Auto Match
Apple        → AAPL
Tesla        → TSLA  
Tencent      → 00700.HK
Maotai       → SH600519
```

## 📡 Data Sources & APIs

### 🎯 Multi-tier Data Strategy

System adopts multi-source + automatic fault tolerance mechanism to ensure data acquisition reliability:

```
Stock Code → [Chinese Stock?] → [Tencent API] → [Success?] → Return Data
                    │              │           │
                    ↓              ↓           ↓ Failed
                [Finnhub API] → [Success?] → [Mock Data] → Return Data
```

### 📊 Data Source Details

| Priority | API Name | Applicable Markets | Data Completeness | Update Frequency |
|:--------:|----------|-------------------|-------------------|------------------|
| 🥇 **1** | **Tencent API** | 🇨🇳 A-Share Markets | Complete (OHLC) | Real-time |
| 🥈 **2** | **Finnhub API** | 🇺🇸 US / 🇭🇰 HK Markets | Basic Data | Real-time |
| 🥉 **3** | **Mock Data** | All Markets | Complete Demo Data | Real-time Generated |

### 🔄 Fault Tolerance

- **Auto Retry**: Automatically try next data source when API fails
- **Smart Selection**: Choose optimal data source based on stock type
- **Fallback Guarantee**: Ultimately provide mock data to ensure program availability

## 📁 Project Structure

```
stock-go/
│
├── main.go              # 🚀 Main program file (contains all logic)
├── go.mod               # 📦 Go module dependencies
├── go.sum               # 🔒 Dependency version lock file
│
├── config.yaml          # ⚙️ System configuration file (user editable)
├── portfolio.json       # 📊 Portfolio data (auto-generated)
├── stock-monitor        # ⚙️ Compiled executable
│
├── README.md            # 📝 Chinese documentation
└── README_EN.md         # 📝 English documentation
```

### 💾 Data Storage

**config.yaml** configuration file example:
```yaml
# Stock Monitor System Configuration File
system:
    language: en          # Default language: "zh" (Chinese) or "en" (English)
    auto_start: true      # Auto enter monitoring mode when data exists
    debug_mode: false     # Debug mode switch

display:
    color_scheme: professional   # Color scheme: "professional", "simple"
    decimal_places: 3           # Price decimal places (1-4)
    table_style: light          # Table style: "light", "bold", "simple"

update:
    refresh_interval: 5   # Refresh interval (seconds)
    auto_update: true     # Enable auto update
```

**portfolio.json** example:
```json
{
  "stocks": [
    {
      "code": "SH601138",
      "name": "Industrial Fulian",
      "cost_price": 47.963,
      "quantity": 400,
      "price": 61.9,
      "change": 2.86,
      "change_percent": 4.84
    }
  ]
}
```

**watchlist.json** example:
```json
{
  "stocks": [
    {
      "code": "SH600410",
      "name": "Huasheng Tiancheng",
      "tag": "-"
    },
    {
      "code": "SH600519",
      "name": "Kweichow Moutai",
      "tag": "-"
    },
    {
      "code": "SZ001309",
      "name": "Demingli",
      "tag": "趋势"
    }
  ]
}
```

## 🏭 Technical Architecture

### 🔧 Core Technology Stack

```
🖥️ User Interface ← Bubble Tea Framework
     │
     ├─ 📋 Data Display ← Go-Pretty Table Library
     │
     ├─ 📡 Data Fetching ← HTTP Client + Encoding Conversion
     │
     └─ 💾 Data Storage ← JSON Files + YAML Config
```

### 📦 Dependency Details

| Component | Version | Function | Advantages |
|-----------|---------|----------|------------|
| **Bubble Tea** | `v1.3.6` | Terminal UI Framework | • Responsive interaction<br>• Real-time event handling<br>• Modern experience |
| **Go-Pretty** | `v6.6.8` | Table Layout Library | • Chinese character alignment<br>• Rich style support<br>• Out-of-the-box |
| **Golang Text** | `v0.28.0` | Encoding Conversion | • GBK to UTF-8<br>• Multi-language support<br>• Official library |
| **YAML v3** | `v3.0.1` | Configuration File Handling | • YAML format support<br>• Structured configuration<br>• User-friendly |

### ⚙️ Install Dependencies

```bash
# Auto download all dependencies
go mod download

# Or manually install core dependencies
go get github.com/charmbracelet/bubbletea@v1.3.6
go get github.com/jedib0t/go-pretty/v6@v6.6.8
go get golang.org/x/text@v0.28.0
go get gopkg.in/yaml.v3
```

## System Requirements

- Go 1.18 or higher
- Internet connection (for fetching stock data)
- Windows, macOS, Linux support
- Color-capable terminal (recommended)

## 🔧 Troubleshooting

### ⚠️ Common Issues & Solutions

| Issue | Possible Causes | Solutions |
|-------|----------------|----------|
| 🚫 Stock data shows 0 | • Wrong stock code<br>• Network issues<br>• API limits | • Check code format<br>• Check network connection<br>• Retry later |
| 🎨 Color display issues | • Terminal doesn't support colors<br>• ANSI code issues | • Use color-capable terminal<br>• Check terminal settings |
| 🔤 Chinese text garbled | • Encoding issues<br>• Font not supported | • System handles automatically<br>• Check terminal font |
| ⏱️ Response delay | • Slow network connection<br>• Slow API response | • Check network status<br>• Switch network environment |

### 🔍 Debug Mode

Enable "Debug Mode" in main menu to get more detailed error information:

```
=== Stock Monitor System ===

  Stock List
  Stock Search
  Add Stock
  Edit Stock
  Remove Stock
► Debug Mode: On    # Click to toggle
  Exit
```

### 📞 Getting Help

If you encounter issues you can't solve, please provide:

- ⚙️ Operating system version
- 🚀 Go language version
- 📄 Error log screenshots
- 🌐 Network environment description
- 💰 Related stock codes

## 🌟 Special Features

### 🎨 Smart Color System

System adopts professional stock software color standards:

- 🔴 **Red**: Profit/gain values (> 0.001)
- 🟢 **Green**: Loss/decline values (< -0.001)
- ⚪ **White**: Neutral values (≈ 0), such as 0% change, $0 P&L

### 🕰️ Real-time Update Mechanism

- **Update Frequency**: Auto refresh every 5 seconds
- **Smart Caching**: Avoid frequent API requests
- **Fault Tolerance**: Auto fallback when API fails

### 📊 Precise Calculations

- **Today's Change**: Based on previous close `(Current Price - Previous Close) / Previous Close × 100%`
- **P&L Statistics**: Real-time calculation of today's P&L, position P&L, P&L rate
- **Market Value**: Current Price × Share Quantity

## 📈 Version History

### 🌟 v4.5 - Advanced Sorting System & Interaction Optimization 🚀 **Professional Sorting Update**

**📊 Bubble Sort System**:
- ✅ **Dual List Sorting**: Both portfolio and watchlist support ascending/descending sorting by table header fields
- ✅ **Bubble Sort Algorithm**: Uses classic bubble sort algorithm to ensure sorting stability and reliability
- ✅ **Multi-field Support**: Portfolio supports 11 field sorting, watchlist supports 7 field sorting
- ✅ **Real-time Data Sorting**: Watchlist sorts based on real-time stock price data for accurate results

**🎯 Smart User Experience**:
- ✅ **Smart Cursor Positioning**: When re-entering sort menu, cursor automatically positions to current sort field
- ✅ **Sort Direction Indicators**: Table headers display ↑(ascending) and ↓(descending) arrows for clarity
- ✅ **Default Unsorted State**: Application starts with clean headers, indicators only appear after user sorts
- ✅ **Independent Sort States**: Portfolio and watchlist sort states are completely independent

**⚡ Sort Operation Optimization**:
- ✅ **Hotkey Sorting**: Press `S` key in list pages to quickly enter sort settings
- ✅ **One-key Toggle**: Enter key in sort menu quickly toggles ascending/descending
- ✅ **Clear Sorting**: Press `C` key to clear current sort and restore original data order
- ✅ **Smart Reset**: Auto-clear sort state after adding/deleting/modifying stocks to avoid data confusion

**🔧 Technical Implementation Highlights**:
- ✅ **Memory Sorting**: All sort states stored in memory, no impact on original data files
- ✅ **State Isolation**: Two lists use completely independent sort state variable sets
- ✅ **Data Recovery**: Clearing sort reloads original file data for complete restoration
- ✅ **Boundary Safety**: Sort operations include complete boundary checking and error handling

**📋 Supported Sort Fields**:

**Portfolio** (11 fields):
```
Stock Code | Stock Name | Current Price | Cost Price | Today's Change% | Today's P&L | Position P&L | P&L Rate | Market Value | Quantity
```

**Watchlist** (7 fields):
```
Tag | Stock Code | Stock Name | Current Price | Today's Change% | Turnover Rate | Volume
```

**⌨️ Sort Function Hotkeys**:
```
S Key: Enter sort settings menu (smart positioning to current sort field)
↑↓ Keys: Select sort field in sort menu
Enter: Apply sort or toggle ascending/descending
C Key: Clear current sort, restore original data order
ESC/Q: Return to list page
```

**💡 Usage Scenario Examples**:
- 📈 **P&L Analysis**: Sort by "P&L Rate" descending to view best performing stocks
- 💰 **Value Sorting**: Sort by "Market Value" ascending/descending to manage portfolio allocation
- 📊 **Change Monitoring**: Sort by "Today's Change%" descending to focus on daily hot stocks
- 🔤 **Code Sorting**: Sort by "Stock Code" ascending for quick lookup of specific stocks
- 🏷️ **Tag Grouping**: Sort watchlist by "Tag" for categorized viewing

---

### 📅 Historical Versions

<details>
<summary>🔽 Click to view historical version details</summary>

### 🌟 v4.4 - Watchlist Tag Grouping Feature 🚀 **Smart Grouping Update**

**🏷️ Tag Grouping System**:
- ✅ **Stock Tag Management**: Watchlist supports adding custom tags to each stock for classification management
- ✅ **Quick Tag Hotkey**: Press `T` key in watchlist to quickly add or modify tags for the selected stock
- ✅ **Chinese Tag Support**: Perfect support for Chinese tag input, such as "趋势" (Trend), "价值" (Value), "成长" (Growth), etc.
- ✅ **Group View Function**: Press `G` key to enter group selection page, select a tag to display only stocks under that tag

**🎯 Tag Operation Experience**:
- ✅ **Default Tags**: Legacy data and untagged stocks default to display `-` tag
- ✅ **Tag Column Display**: Watchlist adds new `Tags` column, showing real-time tag information for each stock
- ✅ **Filter Status Display**: When using group filtering, interface displays the current filtered tag name
- ✅ **Quick Clear Filter**: Press `C` key to quickly clear tag filter and return to display all stocks state

**🔧 Cursor Control Optimization**:
- ✅ **Cursor Position Fix**: Fixed cursor movement exceeding filtered data range when using group filtering
- ✅ **Boundary Check Correction**: Cursor movement strictly based on filtered stock count for boundary checking
- ✅ **Auto Reset**: After all tag-related operations complete, cursor automatically resets to first stock position

**💡 Usage Scenario Examples**:
- 🎯 **Investment Strategy Classification**: Group stocks by strategy tags like "Value Investing", "Growth Stocks", "Defensive"
- 🏢 **Industry Classification Management**: Organize stocks by industry tags like "Technology", "Healthcare", "New Energy"
- 📈 **Attention Level Classification**: Use attention level tags like "High Priority", "Long-term Hold", "Short-term Opportunity"
- 🔄 **Stage Management**: Track investment process with status tags like "To Buy", "Holding", "Watching"

**⌨️ Tag Function Hotkeys**:
```
T Key: Add/modify tag for selected stock (supports Chinese input)
G Key: Enter group view mode, select tag group to view
C Key: Clear current tag filter, display all stocks
```

### 🌟 v4.3 - User Interface Interaction Enhancement and Pagination Display Optimization 🚀 **UI Experience Update**

**⌨️ Interaction Operation Optimization**:
- ✅ **Hotkey Adjustment**: Changed watchlist add hotkey from 'S' to 'A' for more intuitive operation
- ✅ **Search Results Tabulation**: Search results displayed in professional table format including Name│Price│PrevClose│Open│High│Low│Today's Change│Turnover│Volume
- ✅ **Keyboard Conflict Resolution**: Debug mode uses PageUp/PageDown, stock lists use up/down arrows to avoid operation conflicts

**📊 Pagination Display System**:
- ✅ **Smart Pagination**: Portfolio and watchlist support pagination browsing, default 10 rows per page
- ✅ **Configurable Row Count**: New `max_lines` config option for users to customize display rows based on screen resolution
- ✅ **Cursor Navigation**: Added independent cursor column showing current selected row pointer arrow (►)
- ✅ **Position Display**: Real-time display of current stock position and total count (e.g., Row 3/Total 15)

**🎯 Display Logic Optimization**:
- ✅ **First Row Cursor**: Fixed cursor defaulting to first row instead of last row when entering lists
- ✅ **Data Order**: Fixed watchlist initially showing first N rows instead of last N rows
- ✅ **Cursor Visibility**: Resolved cursor invisibility issue when first entering watchlist
- ✅ **Independent Cursor Column**: Cursor (►) displayed in separate column, not affecting stock name display

**⚙️ Configuration File Enhancement**:
- ✅ **Display Row Configuration**: `display.max_lines` configurable for stocks per page (recommended: 1080p=10 rows, 1440p=15 rows, 4K=20 rows)
- ✅ **Config File Optimization**: Removed `config.yml.example`, unified use of `config_demo.yaml` as reference configuration
- ✅ **Bilingual Config Comments**: Configuration file includes complete Chinese and English bilingual comment descriptions

**💡 User Experience Enhancement**:
- 🎮 **Smooth Page Turning**: Support up/down arrow keys for 10-row pagination browsing, more convenient for large datasets
- 📍 **Precise Positioning**: Real-time display of current browsing position for user awareness of data range
- 🔍 **Clear Identification**: Cursor arrow intuitively shows current selected stock row
- ⚙️ **Personalized Customization**: Flexible display density adjustment based on different screen sizes

### 🌟 v4.2 - Portfolio Data Optimization and P&L Analysis Enhancement 🚀 **Data Optimization Update**

**📊 P&L Calculation Logic Optimization**:
- ✅ **Position P&L Correction**: Fixed position P&L calculation logic to ensure correct display based on cost price
- ✅ **Today's P&L Addition**: Added "Today's P&L" column showing P&L amount from daily price changes
- ✅ **Enhanced P&L Analysis**: Provides three-dimensional analysis: Today's Change% (percentage), Today's P&L (amount), Position P&L (total P&L)

**📋 Table Layout Optimization**:
- ✅ **Header Order Adjustment**: Optimized to logical sequence `PrevClose | Price | Cost` for better price comparison
- ✅ **Cost Price Display Optimization**: Removed color display from cost price column as neutral reference price
- ✅ **Data Column Expansion**: Portfolio expanded from 13 to 14 columns providing more detailed P&L analysis

**🧮 Calculation Formula Enhancement**:
- ✅ **Today's P&L**: `(Current Price - Previous Close) × Quantity` - reflects P&L from daily price changes
- ✅ **Position P&L**: `(Current Price - Cost Price) × Quantity` - reflects overall investment P&L status
- ✅ **P&L Rate**: `(Current Price - Cost Price) / Cost Price × 100%` - investment return rate

**🎯 User Experience Enhancement**:
- 🔧 **Data Alignment Correction**: Fixed total row data misalignment issues, ensuring correct column data correspondence
- 📱 **Display Logic Optimization**: Simplified redundant data columns, highlighted core P&L indicators
- 🌈 **Rational Color Display**: Cost price no longer displays color, highlighting price change importance

**📋 Current Portfolio Display**:
```
Code | Name | PrevClose | Price | Cost | Open | High | Low | Quantity | Today% | TodayP&L | PositionP&L | P&LRate | Value
```

**💡 Example Illustration** (ZhaoWei Motor):
- Current Price: 142.47, Cost Price: 145.962, Previous Close: 137.19
- Today's Change: +3.85% (price change relative to yesterday)
- Today's P&L: +528 yuan (profit from today's price change)
- Position P&L: -349.2 yuan (still in loss relative to cost price)

**🌟 v4.1 - Watchlist Enhancement and User Experience Optimization 🚀**

**📊 Watchlist Data Enhancement**:
- ✅ **Removed Change Amount Display**: Simplified watchlist interface by removing redundant change amount column
- ✅ **Added Turnover Rate Display**: New turnover rate column in watchlist showing stock liquidity indicators
- ✅ **Added Volume Display**: New volume column in watchlist with intelligent formatting (billion, million, thousand units)
- ✅ **Data Column Optimization**: Expanded watchlist from 8 to 10 columns for more comprehensive market data

**⌨️ Shortcut Operation Enhancement**:
- ✅ **S-Key Quick Search**: Watchlist interface now supports pressing S key to directly jump to stock search function
- ✅ **Multi-language Shortcut Tips**: Chinese and English interfaces automatically display corresponding shortcut key instructions
- ✅ **Seamless Operation Experience**: No need to return to main menu, directly search new stocks from watchlist

**⚙️ Startup Module Configuration**:
- ✅ **Configurable Startup Module**: New `startup_module` configuration option to choose which module to enter on startup
- ✅ **Portfolio Mode**: Configure `startup_module: "portfolio"` to prioritize entering holdings monitoring page on startup
- ✅ **Watchlist Mode**: Configure `startup_module: "watchlist"` to prioritize entering watchlist viewing page on startup

**🎉 v4.0 - Chinese Stock Search Core Fix 🚀**

**🔧 Core Issues Fixed**:
- ✅ **HTTP Headers Enhancement**: Added complete browser headers for Tencent search API and price API, resolving API access permission issues
- ✅ **Unicode Encoding Parser**: Fixed Unicode-encoded Chinese character parsing from Tencent API (e.g., `\u5de5\u4e1a\u5bcc\u8054` → `Industrial Foxconn`)
- ✅ **Multi-result Processing**: Correctly handle multiple search results returned by API, supporting result lists separated by `^`
- ✅ **Search Logic Refactor**: Removed problematic keyword matching logic, directly return API's first accurate result

**🎯 Fix Results**:
- 🔍 **Chinese Stock Search 100% Available**: Support real-time search for any Chinese stock names (e.g., Industrial Foxconn, Hang Seng Tech, BYD, Tencent, etc.)
- ⚡ **Stable Search Response**: Significantly improved API request success rate, no more "JSON parsing failed" errors
- 📊 **Complete Price Data**: Correctly retrieve complete real-time price and stock information after search
- 🔄 **Smooth Search Flow**: Seamless connection from Chinese name search to price retrieval


**📝 User Experience Improvements**:
- 🎯 **Search and Use Immediately**: Input "工业富联" (Industrial Foxconn) and immediately get complete SH601138 information
- 💯 **Success Rate Boost**: Chinese stock search success rate improved from unstable to nearly 100%
- 🔄 **Error Elimination**: Completely solved "JSON parsing failed" and "unable to get stock information" errors
- ⚡ **Faster Response**: Optimized API requests for faster and more stable responses

**🎯 Actual Test Verification**:
- ✅ 工业富联 (Industrial Foxconn) → SH601138 ✅ Price retrieval successful
- ✅ 恒生科技 (Hang Seng Tech) → SH513180 ✅ Price retrieval successful  
- ✅ 比亚迪 (BYD) → SZ002594 ✅ Price retrieval successful
- ✅ 腾讯 (Tencent) → SH000847 ✅ Price retrieval successful

**v3.1 - Watchlist Feature Major Update**

**Core New Features**:
- ⭐ **Watchlist Module**: Brand new stock watchlist functionality for quickly viewing stocks of interest
- 🔄 **Search Result Actions**: Added "Add to Watchlist" and "Add to Portfolio" operation options after stock search
- 📊 **Real-time Market Display**: Watchlist shows complete real-time market data (9-column data display)
- 🗃️ **Independent Data Management**: Watchlist and portfolio are stored and managed separately
- 🎯 **Smart Navigation**: Automatic redirection to corresponding function pages after operations
- 🔍 **Real API Search**: Reconstructed Chinese stock search, supporting real API queries for any stock names
- 🎯 **Interface Simplification**: Removed independent "Add Stock" menu, stock adding fully integrated into search interface
- 🎛️ **Feature Integration**: Integrated modify and delete stock functions into portfolio list via hotkeys
- ⏱️ **Real-time Sync**: Watchlist supports 5-second interval auto-refresh, consistent with portfolio list

**Feature Characteristics**:
- 📱 **Quick Addition**: One-click addition to watchlist through stock search
- ✅ **Duplicate Detection**: Automatically detects if stock is already in watchlist to avoid duplicates
- 🔧 **Flexible Management**: Support viewing, adding, and deleting watchlist stocks
- 💾 **Data Persistence**: Watchlist data saved to `watchlist.json` file
- 🌐 **Multi-language Support**: Complete Chinese and English bilingual interface support

**Search Function Revolution**:
- 🌐 **Real API Search**: Use Tencent Finance and Sina Finance APIs for real-time stock name search
- 🔍 **Full Coverage Search**: Support any Chinese stock names, no longer limited to hardcoded mapping tables
- 🎯 **Multi-strategy Fault Tolerance**: 5-layer search strategy ensures high success rate and system stability
- 📊 **Smart Parsing**: Automatically handle multiple API response formats with strong compatibility
- ⚡ **Keyword Optimization**: Automatically generate search keyword variations to improve matching accuracy

**Interface Optimization**:
- 🎨 **Unified UI Style**: Watchlist interface maintains consistent professional coloring with monitoring interface
- ⌨️ **Convenient Operations**: D key for quick deletion, number keys for quick addition, more intuitive operations
- 🔄 **Status Feedback**: Real-time success/failure message prompts for operations
- 📱 **Smart Navigation**: Automatic redirection after operations, enhancing user experience
- 📝 **Terminology Optimization**: "Stock List" renamed to "Portfolio" for more accurate function description
- 🎯 **Menu Simplification**: Removed independent "Add Stock", "Edit Stock", "Delete Stock" options for optimized function integration
- ⌨️ **Shortcut Operations**: Portfolio supports E key editing, D key deletion for more convenient and efficient operations
- 🔄 **Real-time Updates**: Watchlist page added 5-second interval auto-refresh and update time display
- 🔀 **Smart Navigation**: Auto-return to portfolio after completing edit/delete operations from portfolio list
- 🎯 **Real Data**: Removed hardcoded mapping and simulated data, only display real API-acquired stock information

**v3.0 - Configuration System & Comprehensive Multi-language Support**

**Major Updates**:
- ⚙️ **YAML Configuration File**: New `config.yaml` system configuration file for customizable startup parameters
- 🌏 **Complete Multi-language Support**: Full support for Chinese and English interfaces, including all menus and interactions
- 🎨 **Cultural Color Adaptation**: Chinese interface (red=gain/green=loss) vs English interface (green=gain/red=loss)
- 🔧 **Secondary Language Selection**: Dedicated language selection page for better user experience

**Configuration Features**:
- 📝 **Configurable Options**: Default language, auto-start mode, debug switch, display settings, update intervals, etc.
- 💾 **Real-time Save**: Settings modified through interface (language, debug mode) automatically saved to config file
- 🛡️ **Error Handling**: Automatically uses default configuration when config file is missing or has format errors
- 📖 **Bilingual Comments**: Configuration file includes detailed Chinese and English explanations

**Multi-language Enhancements**:
- 🔄 **Interface Localization**: All user interface text completely localized
- 🎯 **Smart Adaptation**: Automatically adjusts color display standards based on language
- 📱 **Consistent Experience**: All modules (monitoring, adding, editing, searching, deleting) unified multi-language support

**v2.5 - Interface Logic Optimization**
- ✨ **Smart Startup**: Auto-enter monitoring mode when portfolio data exists
- 🎯 **One-click Access**: Main menu "Stock List" directly enters real-time monitoring
- ⏪ **Multi-key Return**: Support ESC, Q, M keys for multiple return methods
- 🧹 **Streamlined Menu**: Remove duplicate functions, cleaner menu
- 💬 **Message Management**: Fix persistent success message issues

**v2.4 - Stock Editing & Enhanced Stock List View**
- ✅ New stock editing feature: Modify cost price and quantity of existing stocks through interactive interface
- ✅ Enhanced stock list view: Real-time price fetching with display of today's change, daily P&L, total P&L, P&L rate, and market value
- ✅ Unified color display logic: Stock list view uses same color scheme as monitoring interface
- ✅ Portfolio summary: Stock list view shows overall P&L statistics at bottom
- ✅ Interaction optimization: Pre-fill current values when editing stocks for better user experience

**v2.3 - Smart Color Display System**
- ✅ Smart color judgment: Each value determines color based on its own value
- ✅ White neutral display: Zero values shown in white (e.g., 0% today's change, $0 daily P&L)
- ✅ Precise floating-point comparison: Uses epsilon values to avoid precision issues
- ✅ Professional stock software color standards: Red up, green down, white flat

**v2.2 - Stock Monitoring Data Enhancement**
- ✅ Added open price, high price, low price display
- ✅ Real-time today's change calculation: based on previous close fluctuation
- ✅ Upgraded monitoring table to 13-column detailed data display
- ✅ Optimized table column order: Today's change positioned left of daily P&L
- ✅ Tencent API and mock data support complete price data

**v2.1 - Stock List View Feature**
- ✅ Added stock list view function with table display of stock basic information
- ✅ Display serial number, stock code, stock name, quantity, cost price
- ✅ Portfolio statistics information display
- ✅ Optimized main menu structure and user interaction experience

**v2.0 - Bubble Tea Refactored Version**
- ✅ Integrated Bubble Tea framework for modern terminal interface
- ✅ Real-time keyboard response without confirmation prompts
- ✅ Used go-pretty library to solve Chinese character alignment issues
- ✅ Added profit/loss color display (red for profit, green for loss)
- ✅ Enhanced price display precision to 3 decimal places
- ✅ Stock separators for improved table readability

**v1.0 - Base Version**
- ✅ Multi-API data sources (Tencent Finance, Finnhub, Mock Data)
- ✅ Chinese stock name GBK encoding conversion
- ✅ Basic command-line interactive interface
- ✅ JSON data persistence storage

</details>

## 📝 Usage Notes

### ✨ Product Highlights

- 🎮 **Modern Experience**: Smooth terminal interface built with Bubble Tea framework
- 🔍 **Precise Data**: 3 decimal precision, professional-grade data display
- 🌏 **Global Support**: Complete coverage of A-shares, US stocks, Hong Kong stocks
- 💾 **Data Persistence**: Local JSON storage, never lose data
- 🌈 **Smart Display**: Professional stock software color scheme

### 📅 Optimal Usage Times

| Time Period | Market Status | Data Quality |
|-------------|---------------|-------------|
| **09:30-15:00** | 🟢 A-Share Trading Hours | ⭐⭐⭐⭐⭐ Real-time Data |
| **21:30-04:00** | 🇺🇸 US Trading Hours | ⭐⭐⭐⭐⭐ Real-time Data |
| **Non-trading Hours** | 🔴 Market Closed | ⭐⭐⭐ Previous Close Price |

### 🚀 Quick Start Guide

1. **First Time Use**: Enter main menu directly, add some stocks first
2. **After Adding**: Program auto-enters monitoring mode on restart
3. **Daily Use**: View real-time data directly, adjust positions when needed

---

> 📝 **Friendly Reminder**: Please use during trading hours for most accurate data. Non-trading hours display the last trading price.