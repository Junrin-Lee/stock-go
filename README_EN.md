# Stock Monitor

> ğŸ¤– **AI Generated Repository**: This entire project was generated by AI, including code architecture, implementation, and documentation.
---

ğŸ“– **Documentation**: [English](README_EN.md) | [ä¸­æ–‡](README.md)

## ğŸŒŸ Project Overview

Stock Monitor is a command-line terminal stock monitoring tool designed for investors.

### ğŸ¯ Core Features

- **ğŸ”„ Real-time Monitoring** - 5-second interval automatic price refresh, capture every trading moment
- **ğŸ“Š Professional Analysis** - 14-column detailed data display including OHLC, today's P&L, position P&L, P&L rate analysis, and market value statistics
- **ğŸ¨ Smart Display** - Professional stock software color standards: red for gains, green for losses, white for neutral
- **ğŸ’¼ Portfolio Management** - Complete position management with add, edit, and delete stock operations
- **ğŸŒ Global Markets** - Support for A-shares, US stocks, Hong Kong stocks and other major market code formats
- **ğŸ’¾ Data Persistence** - Local JSON storage, portfolio data never lost

## âœ¨ Features

### ğŸ“± Modern Interactive Interface
- Responsive terminal UI built with Bubble Tea framework
- Real-time keyboard response without waiting for confirmation
- Smooth state transitions and menu navigation
- Support for arrow keys, WASD, and Vim-style shortcuts

### ğŸ“ˆ Real-time Data Monitoring
- **Auto Updates**: Refresh stock price data every 5 seconds
- **Multi-dimensional Data**: Current price, open price, high price, low price, previous close
- **Change Analysis**: Precise change percentage based on previous close
- **P&L Statistics**: Real-time calculation of today's P&L, position P&L, and P&L rate

### ğŸ’¼ Portfolio Management
- **Stock Search**: Support stock code or Chinese name search â­ v4.0 Perfect Fix
- **Position Management**: Add, edit, delete stocks in investment portfolio
- **Cost Tracking**: Record purchase cost price and share quantity
- **Auto Calculation**: Real-time calculation of market value, P&L and other key metrics

### ğŸ¨ Professional Data Display
- Professional table layout using go-pretty library
- Perfect Chinese character width alignment
- Smart color system: red (profit/gain), green (loss/decline), white (neutral)
- 14-column detailed data display covering all key investment indicators

## ğŸš€ Quick Start

### ğŸ“¦ Requirements

- **Go Version**: 1.18 or higher
- **Network Connection**: For fetching real-time stock data
- **System Support**: Windows, macOS, Linux
- **Terminal**: Color display support (recommended)

### âš¡ Installation & Setup

#### 1ï¸âƒ£ Clone Repository
```bash
git clone <repository-url>
cd stock-go
```

#### 2ï¸âƒ£ Install Dependencies
```bash
go mod download
```

#### 3ï¸âƒ£ Build Program
```bash
go build -o cmd/stock-monitor main.go
```

#### 4ï¸âƒ£ Run Program
```bash
./cmd/stock-monitor
```

### ğŸ® User Guide

#### âŒ¨ï¸ Keyboard Shortcuts
- **Navigation**: `â†‘â†“` Arrow keys or `W/S` or `J/K` (Vim style)
- **Confirm**: `Enter` or `Space` key
- **Return**: `ESC` or `Q` key
- **Force Quit**: `Ctrl+C`
- **Portfolio Specific**:
  - `E` key: Edit selected stock
  - `D` key: Delete selected stock
  - `S` key: Enter sort settings menu â­ v4.5 New
- **Watchlist Specific**:
  - `A` key: Add stock to watchlist
  - `D` key: Delete selected stock
  - `S` key: Enter sort settings menu â­ v4.5 New
  - `T` key: Add/modify tag for selected stock â­ v4.4 New
  - `G` key: Enter group view mode by tags â­ v4.4 New
  - `C` key: Clear tag filter, show all stocks â­ v4.4 New
- **Sort Menu Specific** â­ v4.5 New:
  - `â†‘â†“` keys: Select sort field
  - `Enter` key: Apply sort or toggle ascending/descending
  - `C` key: Clear current sort, restore original data order
  - `ESC/Q` keys: Return to list page

#### ğŸ  Main Menu Navigation
```
=== Stock Monitor System ===

â–º Portfolio         # Enter real-time monitoring interface (E key edit, D key delete)
  Watchlist         # View watchlist â­ New Feature
  Stock Search      # Search stock information and add stocks
  Debug Mode: Off   # Toggle debug information
  Language: English # Language selection
  Exit             # Save and exit program
```

#### ğŸ’¡ Smart Startup
- **With Portfolio Data**: Program automatically enters monitoring mode
- **No Portfolio Data**: Shows main menu, guides user to add stocks

## âš™ï¸ Configuration File

### ğŸ“„ Configuration Guide

The system provides a `config.yaml` configuration file that users can edit to customize system startup parameters:

#### ğŸ”§ Configuration Options

| Setting | Default | Description | Possible Values |
|---------|---------|-------------|-----------------|
| `system.language` | `"en"` | Default system language | `"zh"` (Chinese), `"en"` (English) |
| `system.auto_start` | `true` | Auto enter monitoring mode when data exists | `true`, `false` |
| `system.startup_module` | `"portfolio"` | Default module to enter on startup â­ v4.1 New | `"portfolio"` (holdings), `"watchlist"` (favorites) |
| `system.debug_mode` | `false` | Debug mode switch | `true`, `false` |
| `display.color_scheme` | `"professional"` | Color scheme | `"professional"`, `"simple"` |
| `display.decimal_places` | `3` | Price decimal places | `1-4` |
| `display.table_style` | `"light"` | Table style | `"light"`, `"bold"`, `"simple"` |
| `update.refresh_interval` | `5` | Data refresh interval (seconds) | Any positive integer |
| `update.auto_update` | `true` | Enable auto update | `true`, `false` |

#### ğŸ’¡ Configuration Features

- **Auto Creation**: Default configuration file is automatically created on first run
- **Real-time Save**: Settings changed through the interface (like language, debug mode) are automatically saved
- **Error Handling**: Automatically uses default configuration when config file has errors
- **Bilingual Comments**: Configuration file includes both Chinese and English comments

#### ğŸ› ï¸ Manual Configuration Editing

You can directly edit the `config.yaml` file to modify settings:

```bash
# Edit config file with any text editor
nano config.yaml
# or
vim config.yaml
```

**Note**: Restart the program after modifying the configuration file for changes to take effect.

## ğŸ“Š Feature Details

### â­ Watchlist Feature (New)

The watchlist module is a stock watch list that allows you to quickly view real-time data of stocks of interest without adding them to your investment portfolio.

#### ğŸ¯ Key Features
- **Quick Watch**: One-click addition to watchlist after stock search
- **Real-time Refresh**: Automatically update watchlist real-time market data every 5 seconds â­ New
- **Complete Data**: Display detailed market data for watchlist stocks (including tags, turnover rate and volume)
- **Tag Grouping**: Support adding custom tags to stocks and view by tag groups â­ v4.4 New
- **Flexible Management**: Support adding, deleting, tagging, and group filtering of watchlist stocks
- **Independent Storage**: Watchlist and portfolio are managed separately

#### ğŸ“± Usage Workflow

**1. Add to Watchlist**
```
Stock Search â†’ Enter stock code/name â†’ View details â†’ Press "1" to add to watchlist â†’ Auto-enter watchlist page
```

**2. Add to Portfolio**
```
Stock Search â†’ Enter stock code/name â†’ View details â†’ Press "2" to add to portfolio â†’ Enter cost and quantity â†’ Auto-enter portfolio monitoring page
```

**3. View Watchlist**
```
Main Menu â†’ Watchlist â†’ Real-time view of all watchlist stocks (auto-refresh every 5 seconds)
```

**4. Delete from Watchlist**
```
Watchlist page â†’ Press "D" key â†’ Select stock to delete â†’ Confirm deletion
```

**5. Quick Search New Stock** â­ v4.1 New
```
Watchlist page â†’ Press "A" key â†’ Direct jump to stock search page
```

**6. Stock Tag Management** â­ v4.4 New
```
Watchlist page â†’ Press "T" key â†’ Add tag to selected stock (supports Chinese) â†’ Press Enter to confirm
```

**7. Group View Function** â­ v4.4 New
```
Watchlist page â†’ Press "G" key â†’ Select tag to view â†’ Display only stocks under that tag
```

**8. Clear Tag Filter** â­ v4.4 New
```
In tag filter state â†’ Press "C" key â†’ Clear filter, display all stocks
```

#### ğŸ”„ New Search Result Actions

After searching for stocks, two operation options are now provided:
- **Press "1" key**: Add to watchlist (watch only, no investment) â†’ Auto-redirect to watchlist page
- **Press "2" key**: Add to portfolio (requires cost price and quantity input) â†’ Auto-redirect to portfolio monitoring page after completion

## ğŸ“Š Features Overview

### ğŸ“ˆ Real-time Monitoring Interface

Once in monitoring mode, the system displays professional stock data tables:

=== Real-time Stock Monitor ===
Update Time(5s): 2024-01-01 15:30:25

| Code | Name | PrevClose | Price | Cost | Open | High | Low | Quantity | Today% | TodayP&L | PositionP&L | P&LRate | Value |
|------|------|-----------|-------|------|------|------|------|----------|--------|----------|-------------|---------|-------|
| SH601138 | Industrial | 59.040 | 61.900 | 47.963 | 58.880 | 63.100 | 58.030 | 400 | +4.84% | +1144.00 | +5574.80 | +29.19% | 24760.00 |

ESC, Q or M to return to main menu

**Table Features**:
- **Smart Colors**: Red for profit/gains, green for loss/declines, white for neutral
- **Real-time Updates**: Automatically refresh latest stock data every 5 seconds
- **Precise Calculations**: All P&L data calculated accurately based on real-time prices
- **Summary Statistics**: Bottom shows overall portfolio P&L status

### ğŸ” Stock Search Function

Support multiple search methods, **v4.0 version perfectly fixed Chinese stock name search**:

```
=== Stock Search ===

Enter stock code or name: å·¥ä¸šå¯Œè”_

Supported formats:
â€¢ Chinese names: å·¥ä¸šå¯Œè”, æ’ç”Ÿç§‘æŠ€, æ¯”äºšè¿ª, è…¾è®¯, etc. â­ v4.0 Perfect Fix, 100% Available
â€¢ Chinese stocks: SH601138, 000001, SZ000002, etc.
â€¢ US stocks: AAPL, TSLA, MSFT, etc.
â€¢ Hong Kong stocks: HK00700, etc.

âœ… v4.0 Update: Chinese search completely fixed, success rate nearly 100%!
```

### â• Add Stock Workflow

**Note**: Adding stocks is now completed through the "Stock Search" function. There is no longer an independent "Add Stock" menu.

**Step 1**: Search for stocks via Stock Search
```
=== Stock Search ===

Enter stock code or name: SH601138_
Supported formats: SH601138, 000001, AAPL, etc.
```

**Step 2**: Choose to add to portfolio
```
Stock Code: SH601138
Stock Name: Industrial Foxconn
Current Price: 61.900

Press "1" to add to watchlist, press "2" to add to portfolio
```

**Step 3**: Enter cost price and quantity (when choosing to add to portfolio)
```
Stock Code: SH601138
Stock Name: Industrial Foxconn
Current Price: 61.900

Enter cost price: 47.963_
Enter quantity: 400_
```

### âœï¸ Edit Position Information

**Note**: Stock editing function has been integrated into the portfolio list. Press **E key** on the portfolio monitoring page to edit stocks.

Edit workflow:
```
Portfolio page â†’ Press E key â†’ Select stock to edit â†’ Enter new cost price and quantity â†’ Auto-return to portfolio
```

Edit interface example:
```
=== Edit Stock ===

Select stock to edit:

â–º 1. Industrial Foxconn (SH601138) - Cost: 47.963, Quantity: 400
  2. Hang Seng Tech Index ETF (SH513180) - Cost: 0.510, Quantity: 10000

Use arrow keys to select, Enter to confirm, ESC or Q to return
```

### ğŸ—‘ï¸ Delete Position Information

**Note**: Stock deletion function has been integrated into the portfolio list. Press **D key** on the portfolio monitoring page to delete stocks.

Delete workflow:
```
Portfolio page â†’ Press D key â†’ Select stock to delete â†’ Confirm deletion â†’ Auto-return to portfolio
```

Delete interface example:
```
=== Delete Stock ===

Select stock to delete:

â–º 1. Industrial Foxconn (SH601138)
  2. Hang Seng Tech Index ETF (SH513180)

Use arrow keys to select, Enter to confirm, ESC or Q to return
```

## ğŸŒ Supported Stock Markets

### ğŸ“ Stock Code Formats

System intelligently recognizes and supports global mainstream stock markets:

| Market | Supported Format | Examples | Auto Conversion |
|--------|------------------|----------|----------------|
| ğŸ‡¨ğŸ‡³ **A-Share Shanghai** | `SH + 6 digits` or `6 digits` | `SH601138`, `601138` | `â†’ 601138.SS` |
| ğŸ‡¨ğŸ‡³ **A-Share Shenzhen** | `SZ + 6 digits` or `6 digits` | `SZ000001`, `000001` | `â†’ 000001.SZ` |
| ğŸ‡ºğŸ‡¸ **US Stocks** | Direct stock codes | `AAPL`, `TSLA`, `MSFT` | No conversion needed |
| ğŸ‡­ğŸ‡° **Hong Kong Stocks** | `HK + 5 digits` or standard format | `HK00700`, `0700.HK` | `â†’ 0700.HK` |

### ğŸ’¡ Chinese Name Search

System supports using Chinese names to search stocks:

```
Chinese Input â†’ Auto Match
Apple        â†’ AAPL
Tesla        â†’ TSLA  
Tencent      â†’ 00700.HK
Maotai       â†’ SH600519
```

## ğŸ“¡ Data Sources & APIs

### ğŸ¯ Multi-tier Data Strategy

System adopts multi-source + automatic fault tolerance mechanism to ensure data acquisition reliability:

```
Stock Code â†’ [Chinese Stock?] â†’ [Tencent API] â†’ [Success?] â†’ Return Data
                    â”‚              â”‚           â”‚
                    â†“              â†“           â†“ Failed
                [Finnhub API] â†’ [Success?] â†’ [Mock Data] â†’ Return Data
```

### ğŸ“Š Data Source Details

| Priority | API Name | Applicable Markets | Data Completeness | Update Frequency |
|:--------:|----------|-------------------|-------------------|------------------|
| ğŸ¥‡ **1** | **Tencent API** | ğŸ‡¨ğŸ‡³ A-Share Markets | Complete (OHLC) | Real-time |
| ğŸ¥ˆ **2** | **Finnhub API** | ğŸ‡ºğŸ‡¸ US / ğŸ‡­ğŸ‡° HK Markets | Basic Data | Real-time |
| ğŸ¥‰ **3** | **Mock Data** | All Markets | Complete Demo Data | Real-time Generated |

### ğŸ”„ Fault Tolerance

- **Auto Retry**: Automatically try next data source when API fails
- **Smart Selection**: Choose optimal data source based on stock type
- **Fallback Guarantee**: Ultimately provide mock data to ensure program availability

## ğŸ“ Project Structure

```
stock-go/
â”‚
â”œâ”€â”€ main.go              # ğŸš€ Main program file (contains all logic)
â”œâ”€â”€ go.mod               # ğŸ“¦ Go module dependencies
â”œâ”€â”€ go.sum               # ğŸ”’ Dependency version lock file
â”‚
â”œâ”€â”€ config.yaml          # âš™ï¸ System configuration file (user editable)
â”œâ”€â”€ portfolio.json       # ğŸ“Š Portfolio data (auto-generated)
â”œâ”€â”€ stock-monitor        # âš™ï¸ Compiled executable
â”‚
â”œâ”€â”€ README.md            # ğŸ“ Chinese documentation
â””â”€â”€ README_EN.md         # ğŸ“ English documentation
```

### ğŸ’¾ Data Storage

**config.yaml** configuration file example:
```yaml
# Stock Monitor System Configuration File
system:
    language: en          # Default language: "zh" (Chinese) or "en" (English)
    auto_start: true      # Auto enter monitoring mode when data exists
    debug_mode: false     # Debug mode switch

display:
    color_scheme: professional   # Color scheme: "professional", "simple"
    decimal_places: 3           # Price decimal places (1-4)
    table_style: light          # Table style: "light", "bold", "simple"

update:
    refresh_interval: 5   # Refresh interval (seconds)
    auto_update: true     # Enable auto update
```

**portfolio.json** example:
```json
{
  "stocks": [
    {
      "code": "SH601138",
      "name": "Industrial Fulian",
      "cost_price": 47.963,
      "quantity": 400,
      "price": 61.9,
      "change": 2.86,
      "change_percent": 4.84
    }
  ]
}
```

**watchlist.json** example:
```json
{
  "stocks": [
    {
      "code": "SH600410",
      "name": "Huasheng Tiancheng",
      "tag": "-"
    },
    {
      "code": "SH600519",
      "name": "Kweichow Moutai",
      "tag": "-"
    },
    {
      "code": "SZ001309",
      "name": "Demingli",
      "tag": "è¶‹åŠ¿"
    }
  ]
}
```

## ğŸ­ Technical Architecture

### ğŸ”§ Core Technology Stack

```
ğŸ–¥ï¸ User Interface â† Bubble Tea Framework
     â”‚
     â”œâ”€ ğŸ“‹ Data Display â† Go-Pretty Table Library
     â”‚
     â”œâ”€ ğŸ“¡ Data Fetching â† HTTP Client + Encoding Conversion
     â”‚
     â””â”€ ğŸ’¾ Data Storage â† JSON Files + YAML Config
```

### ğŸ“¦ Dependency Details

| Component | Version | Function | Advantages |
|-----------|---------|----------|------------|
| **Bubble Tea** | `v1.3.6` | Terminal UI Framework | â€¢ Responsive interaction<br>â€¢ Real-time event handling<br>â€¢ Modern experience |
| **Go-Pretty** | `v6.6.8` | Table Layout Library | â€¢ Chinese character alignment<br>â€¢ Rich style support<br>â€¢ Out-of-the-box |
| **Golang Text** | `v0.28.0` | Encoding Conversion | â€¢ GBK to UTF-8<br>â€¢ Multi-language support<br>â€¢ Official library |
| **YAML v3** | `v3.0.1` | Configuration File Handling | â€¢ YAML format support<br>â€¢ Structured configuration<br>â€¢ User-friendly |

### âš™ï¸ Install Dependencies

```bash
# Auto download all dependencies
go mod download

# Or manually install core dependencies
go get github.com/charmbracelet/bubbletea@v1.3.6
go get github.com/jedib0t/go-pretty/v6@v6.6.8
go get golang.org/x/text@v0.28.0
go get gopkg.in/yaml.v3
```

## System Requirements

- Go 1.18 or higher
- Internet connection (for fetching stock data)
- Windows, macOS, Linux support
- Color-capable terminal (recommended)

## ğŸ”§ Troubleshooting

### âš ï¸ Common Issues & Solutions

| Issue | Possible Causes | Solutions |
|-------|----------------|----------|
| ğŸš« Stock data shows 0 | â€¢ Wrong stock code<br>â€¢ Network issues<br>â€¢ API limits | â€¢ Check code format<br>â€¢ Check network connection<br>â€¢ Retry later |
| ğŸ¨ Color display issues | â€¢ Terminal doesn't support colors<br>â€¢ ANSI code issues | â€¢ Use color-capable terminal<br>â€¢ Check terminal settings |
| ğŸ”¤ Chinese text garbled | â€¢ Encoding issues<br>â€¢ Font not supported | â€¢ System handles automatically<br>â€¢ Check terminal font |
| â±ï¸ Response delay | â€¢ Slow network connection<br>â€¢ Slow API response | â€¢ Check network status<br>â€¢ Switch network environment |

### ğŸ” Debug Mode

Enable "Debug Mode" in main menu to get more detailed error information:

```
=== Stock Monitor System ===

  Stock List
  Stock Search
  Add Stock
  Edit Stock
  Remove Stock
â–º Debug Mode: On    # Click to toggle
  Exit
```

### ğŸ“ Getting Help

If you encounter issues you can't solve, please provide:

- âš™ï¸ Operating system version
- ğŸš€ Go language version
- ğŸ“„ Error log screenshots
- ğŸŒ Network environment description
- ğŸ’° Related stock codes

## ğŸŒŸ Special Features

### ğŸ¨ Smart Color System

System adopts professional stock software color standards:

- ğŸ”´ **Red**: Profit/gain values (> 0.001)
- ğŸŸ¢ **Green**: Loss/decline values (< -0.001)
- âšª **White**: Neutral values (â‰ˆ 0), such as 0% change, $0 P&L

### ğŸ•°ï¸ Real-time Update Mechanism

- **Update Frequency**: Auto refresh every 5 seconds
- **Smart Caching**: Avoid frequent API requests
- **Fault Tolerance**: Auto fallback when API fails

### ğŸ“Š Precise Calculations

- **Today's Change**: Based on previous close `(Current Price - Previous Close) / Previous Close Ã— 100%`
- **P&L Statistics**: Real-time calculation of today's P&L, position P&L, P&L rate
- **Market Value**: Current Price Ã— Share Quantity

## ğŸ“ˆ Version History

### ğŸŒŸ v4.5 - Advanced Sorting System & Interaction Optimization ğŸš€ **Professional Sorting Update**

**ğŸ“Š Bubble Sort System**:
- âœ… **Dual List Sorting**: Both portfolio and watchlist support ascending/descending sorting by table header fields
- âœ… **Bubble Sort Algorithm**: Uses classic bubble sort algorithm to ensure sorting stability and reliability
- âœ… **Multi-field Support**: Portfolio supports 11 field sorting, watchlist supports 7 field sorting
- âœ… **Real-time Data Sorting**: Watchlist sorts based on real-time stock price data for accurate results

**ğŸ¯ Smart User Experience**:
- âœ… **Smart Cursor Positioning**: When re-entering sort menu, cursor automatically positions to current sort field
- âœ… **Sort Direction Indicators**: Table headers display â†‘(ascending) and â†“(descending) arrows for clarity
- âœ… **Default Unsorted State**: Application starts with clean headers, indicators only appear after user sorts
- âœ… **Independent Sort States**: Portfolio and watchlist sort states are completely independent

**âš¡ Sort Operation Optimization**:
- âœ… **Hotkey Sorting**: Press `S` key in list pages to quickly enter sort settings
- âœ… **One-key Toggle**: Enter key in sort menu quickly toggles ascending/descending
- âœ… **Clear Sorting**: Press `C` key to clear current sort and restore original data order
- âœ… **Smart Reset**: Auto-clear sort state after adding/deleting/modifying stocks to avoid data confusion

**ğŸ”§ Technical Implementation Highlights**:
- âœ… **Memory Sorting**: All sort states stored in memory, no impact on original data files
- âœ… **State Isolation**: Two lists use completely independent sort state variable sets
- âœ… **Data Recovery**: Clearing sort reloads original file data for complete restoration
- âœ… **Boundary Safety**: Sort operations include complete boundary checking and error handling

**ğŸ“‹ Supported Sort Fields**:

**Portfolio** (11 fields):
```
Stock Code | Stock Name | Current Price | Cost Price | Today's Change% | Today's P&L | Position P&L | P&L Rate | Market Value | Quantity
```

**Watchlist** (7 fields):
```
Tag | Stock Code | Stock Name | Current Price | Today's Change% | Turnover Rate | Volume
```

**âŒ¨ï¸ Sort Function Hotkeys**:
```
S Key: Enter sort settings menu (smart positioning to current sort field)
â†‘â†“ Keys: Select sort field in sort menu
Enter: Apply sort or toggle ascending/descending
C Key: Clear current sort, restore original data order
ESC/Q: Return to list page
```

**ğŸ’¡ Usage Scenario Examples**:
- ğŸ“ˆ **P&L Analysis**: Sort by "P&L Rate" descending to view best performing stocks
- ğŸ’° **Value Sorting**: Sort by "Market Value" ascending/descending to manage portfolio allocation
- ğŸ“Š **Change Monitoring**: Sort by "Today's Change%" descending to focus on daily hot stocks
- ğŸ”¤ **Code Sorting**: Sort by "Stock Code" ascending for quick lookup of specific stocks
- ğŸ·ï¸ **Tag Grouping**: Sort watchlist by "Tag" for categorized viewing

---

### ğŸ“… Historical Versions

<details>
<summary>ğŸ”½ Click to view historical version details</summary>

### ğŸŒŸ v4.4 - Watchlist Tag Grouping Feature ğŸš€ **Smart Grouping Update**

**ğŸ·ï¸ Tag Grouping System**:
- âœ… **Stock Tag Management**: Watchlist supports adding custom tags to each stock for classification management
- âœ… **Quick Tag Hotkey**: Press `T` key in watchlist to quickly add or modify tags for the selected stock
- âœ… **Chinese Tag Support**: Perfect support for Chinese tag input, such as "è¶‹åŠ¿" (Trend), "ä»·å€¼" (Value), "æˆé•¿" (Growth), etc.
- âœ… **Group View Function**: Press `G` key to enter group selection page, select a tag to display only stocks under that tag

**ğŸ¯ Tag Operation Experience**:
- âœ… **Default Tags**: Legacy data and untagged stocks default to display `-` tag
- âœ… **Tag Column Display**: Watchlist adds new `Tags` column, showing real-time tag information for each stock
- âœ… **Filter Status Display**: When using group filtering, interface displays the current filtered tag name
- âœ… **Quick Clear Filter**: Press `C` key to quickly clear tag filter and return to display all stocks state

**ğŸ”§ Cursor Control Optimization**:
- âœ… **Cursor Position Fix**: Fixed cursor movement exceeding filtered data range when using group filtering
- âœ… **Boundary Check Correction**: Cursor movement strictly based on filtered stock count for boundary checking
- âœ… **Auto Reset**: After all tag-related operations complete, cursor automatically resets to first stock position

**ğŸ’¡ Usage Scenario Examples**:
- ğŸ¯ **Investment Strategy Classification**: Group stocks by strategy tags like "Value Investing", "Growth Stocks", "Defensive"
- ğŸ¢ **Industry Classification Management**: Organize stocks by industry tags like "Technology", "Healthcare", "New Energy"
- ğŸ“ˆ **Attention Level Classification**: Use attention level tags like "High Priority", "Long-term Hold", "Short-term Opportunity"
- ğŸ”„ **Stage Management**: Track investment process with status tags like "To Buy", "Holding", "Watching"

**âŒ¨ï¸ Tag Function Hotkeys**:
```
T Key: Add/modify tag for selected stock (supports Chinese input)
G Key: Enter group view mode, select tag group to view
C Key: Clear current tag filter, display all stocks
```

### ğŸŒŸ v4.3 - User Interface Interaction Enhancement and Pagination Display Optimization ğŸš€ **UI Experience Update**

**âŒ¨ï¸ Interaction Operation Optimization**:
- âœ… **Hotkey Adjustment**: Changed watchlist add hotkey from 'S' to 'A' for more intuitive operation
- âœ… **Search Results Tabulation**: Search results displayed in professional table format including Nameâ”‚Priceâ”‚PrevCloseâ”‚Openâ”‚Highâ”‚Lowâ”‚Today's Changeâ”‚Turnoverâ”‚Volume
- âœ… **Keyboard Conflict Resolution**: Debug mode uses PageUp/PageDown, stock lists use up/down arrows to avoid operation conflicts

**ğŸ“Š Pagination Display System**:
- âœ… **Smart Pagination**: Portfolio and watchlist support pagination browsing, default 10 rows per page
- âœ… **Configurable Row Count**: New `max_lines` config option for users to customize display rows based on screen resolution
- âœ… **Cursor Navigation**: Added independent cursor column showing current selected row pointer arrow (â–º)
- âœ… **Position Display**: Real-time display of current stock position and total count (e.g., Row 3/Total 15)

**ğŸ¯ Display Logic Optimization**:
- âœ… **First Row Cursor**: Fixed cursor defaulting to first row instead of last row when entering lists
- âœ… **Data Order**: Fixed watchlist initially showing first N rows instead of last N rows
- âœ… **Cursor Visibility**: Resolved cursor invisibility issue when first entering watchlist
- âœ… **Independent Cursor Column**: Cursor (â–º) displayed in separate column, not affecting stock name display

**âš™ï¸ Configuration File Enhancement**:
- âœ… **Display Row Configuration**: `display.max_lines` configurable for stocks per page (recommended: 1080p=10 rows, 1440p=15 rows, 4K=20 rows)
- âœ… **Config File Optimization**: Removed `config.yml.example`, unified use of `config_demo.yaml` as reference configuration
- âœ… **Bilingual Config Comments**: Configuration file includes complete Chinese and English bilingual comment descriptions

**ğŸ’¡ User Experience Enhancement**:
- ğŸ® **Smooth Page Turning**: Support up/down arrow keys for 10-row pagination browsing, more convenient for large datasets
- ğŸ“ **Precise Positioning**: Real-time display of current browsing position for user awareness of data range
- ğŸ” **Clear Identification**: Cursor arrow intuitively shows current selected stock row
- âš™ï¸ **Personalized Customization**: Flexible display density adjustment based on different screen sizes

### ğŸŒŸ v4.2 - Portfolio Data Optimization and P&L Analysis Enhancement ğŸš€ **Data Optimization Update**

**ğŸ“Š P&L Calculation Logic Optimization**:
- âœ… **Position P&L Correction**: Fixed position P&L calculation logic to ensure correct display based on cost price
- âœ… **Today's P&L Addition**: Added "Today's P&L" column showing P&L amount from daily price changes
- âœ… **Enhanced P&L Analysis**: Provides three-dimensional analysis: Today's Change% (percentage), Today's P&L (amount), Position P&L (total P&L)

**ğŸ“‹ Table Layout Optimization**:
- âœ… **Header Order Adjustment**: Optimized to logical sequence `PrevClose | Price | Cost` for better price comparison
- âœ… **Cost Price Display Optimization**: Removed color display from cost price column as neutral reference price
- âœ… **Data Column Expansion**: Portfolio expanded from 13 to 14 columns providing more detailed P&L analysis

**ğŸ§® Calculation Formula Enhancement**:
- âœ… **Today's P&L**: `(Current Price - Previous Close) Ã— Quantity` - reflects P&L from daily price changes
- âœ… **Position P&L**: `(Current Price - Cost Price) Ã— Quantity` - reflects overall investment P&L status
- âœ… **P&L Rate**: `(Current Price - Cost Price) / Cost Price Ã— 100%` - investment return rate

**ğŸ¯ User Experience Enhancement**:
- ğŸ”§ **Data Alignment Correction**: Fixed total row data misalignment issues, ensuring correct column data correspondence
- ğŸ“± **Display Logic Optimization**: Simplified redundant data columns, highlighted core P&L indicators
- ğŸŒˆ **Rational Color Display**: Cost price no longer displays color, highlighting price change importance

**ğŸ“‹ Current Portfolio Display**:
```
Code | Name | PrevClose | Price | Cost | Open | High | Low | Quantity | Today% | TodayP&L | PositionP&L | P&LRate | Value
```

**ğŸ’¡ Example Illustration** (ZhaoWei Motor):
- Current Price: 142.47, Cost Price: 145.962, Previous Close: 137.19
- Today's Change: +3.85% (price change relative to yesterday)
- Today's P&L: +528 yuan (profit from today's price change)
- Position P&L: -349.2 yuan (still in loss relative to cost price)

**ğŸŒŸ v4.1 - Watchlist Enhancement and User Experience Optimization ğŸš€**

**ğŸ“Š Watchlist Data Enhancement**:
- âœ… **Removed Change Amount Display**: Simplified watchlist interface by removing redundant change amount column
- âœ… **Added Turnover Rate Display**: New turnover rate column in watchlist showing stock liquidity indicators
- âœ… **Added Volume Display**: New volume column in watchlist with intelligent formatting (billion, million, thousand units)
- âœ… **Data Column Optimization**: Expanded watchlist from 8 to 10 columns for more comprehensive market data

**âŒ¨ï¸ Shortcut Operation Enhancement**:
- âœ… **S-Key Quick Search**: Watchlist interface now supports pressing S key to directly jump to stock search function
- âœ… **Multi-language Shortcut Tips**: Chinese and English interfaces automatically display corresponding shortcut key instructions
- âœ… **Seamless Operation Experience**: No need to return to main menu, directly search new stocks from watchlist

**âš™ï¸ Startup Module Configuration**:
- âœ… **Configurable Startup Module**: New `startup_module` configuration option to choose which module to enter on startup
- âœ… **Portfolio Mode**: Configure `startup_module: "portfolio"` to prioritize entering holdings monitoring page on startup
- âœ… **Watchlist Mode**: Configure `startup_module: "watchlist"` to prioritize entering watchlist viewing page on startup

**ğŸ‰ v4.0 - Chinese Stock Search Core Fix ğŸš€**

**ğŸ”§ Core Issues Fixed**:
- âœ… **HTTP Headers Enhancement**: Added complete browser headers for Tencent search API and price API, resolving API access permission issues
- âœ… **Unicode Encoding Parser**: Fixed Unicode-encoded Chinese character parsing from Tencent API (e.g., `\u5de5\u4e1a\u5bcc\u8054` â†’ `Industrial Foxconn`)
- âœ… **Multi-result Processing**: Correctly handle multiple search results returned by API, supporting result lists separated by `^`
- âœ… **Search Logic Refactor**: Removed problematic keyword matching logic, directly return API's first accurate result

**ğŸ¯ Fix Results**:
- ğŸ” **Chinese Stock Search 100% Available**: Support real-time search for any Chinese stock names (e.g., Industrial Foxconn, Hang Seng Tech, BYD, Tencent, etc.)
- âš¡ **Stable Search Response**: Significantly improved API request success rate, no more "JSON parsing failed" errors
- ğŸ“Š **Complete Price Data**: Correctly retrieve complete real-time price and stock information after search
- ğŸ”„ **Smooth Search Flow**: Seamless connection from Chinese name search to price retrieval


**ğŸ“ User Experience Improvements**:
- ğŸ¯ **Search and Use Immediately**: Input "å·¥ä¸šå¯Œè”" (Industrial Foxconn) and immediately get complete SH601138 information
- ğŸ’¯ **Success Rate Boost**: Chinese stock search success rate improved from unstable to nearly 100%
- ğŸ”„ **Error Elimination**: Completely solved "JSON parsing failed" and "unable to get stock information" errors
- âš¡ **Faster Response**: Optimized API requests for faster and more stable responses

**ğŸ¯ Actual Test Verification**:
- âœ… å·¥ä¸šå¯Œè” (Industrial Foxconn) â†’ SH601138 âœ… Price retrieval successful
- âœ… æ’ç”Ÿç§‘æŠ€ (Hang Seng Tech) â†’ SH513180 âœ… Price retrieval successful  
- âœ… æ¯”äºšè¿ª (BYD) â†’ SZ002594 âœ… Price retrieval successful
- âœ… è…¾è®¯ (Tencent) â†’ SH000847 âœ… Price retrieval successful

**v3.1 - Watchlist Feature Major Update**

**Core New Features**:
- â­ **Watchlist Module**: Brand new stock watchlist functionality for quickly viewing stocks of interest
- ğŸ”„ **Search Result Actions**: Added "Add to Watchlist" and "Add to Portfolio" operation options after stock search
- ğŸ“Š **Real-time Market Display**: Watchlist shows complete real-time market data (9-column data display)
- ğŸ—ƒï¸ **Independent Data Management**: Watchlist and portfolio are stored and managed separately
- ğŸ¯ **Smart Navigation**: Automatic redirection to corresponding function pages after operations
- ğŸ” **Real API Search**: Reconstructed Chinese stock search, supporting real API queries for any stock names
- ğŸ¯ **Interface Simplification**: Removed independent "Add Stock" menu, stock adding fully integrated into search interface
- ğŸ›ï¸ **Feature Integration**: Integrated modify and delete stock functions into portfolio list via hotkeys
- â±ï¸ **Real-time Sync**: Watchlist supports 5-second interval auto-refresh, consistent with portfolio list

**Feature Characteristics**:
- ğŸ“± **Quick Addition**: One-click addition to watchlist through stock search
- âœ… **Duplicate Detection**: Automatically detects if stock is already in watchlist to avoid duplicates
- ğŸ”§ **Flexible Management**: Support viewing, adding, and deleting watchlist stocks
- ğŸ’¾ **Data Persistence**: Watchlist data saved to `watchlist.json` file
- ğŸŒ **Multi-language Support**: Complete Chinese and English bilingual interface support

**Search Function Revolution**:
- ğŸŒ **Real API Search**: Use Tencent Finance and Sina Finance APIs for real-time stock name search
- ğŸ” **Full Coverage Search**: Support any Chinese stock names, no longer limited to hardcoded mapping tables
- ğŸ¯ **Multi-strategy Fault Tolerance**: 5-layer search strategy ensures high success rate and system stability
- ğŸ“Š **Smart Parsing**: Automatically handle multiple API response formats with strong compatibility
- âš¡ **Keyword Optimization**: Automatically generate search keyword variations to improve matching accuracy

**Interface Optimization**:
- ğŸ¨ **Unified UI Style**: Watchlist interface maintains consistent professional coloring with monitoring interface
- âŒ¨ï¸ **Convenient Operations**: D key for quick deletion, number keys for quick addition, more intuitive operations
- ğŸ”„ **Status Feedback**: Real-time success/failure message prompts for operations
- ğŸ“± **Smart Navigation**: Automatic redirection after operations, enhancing user experience
- ğŸ“ **Terminology Optimization**: "Stock List" renamed to "Portfolio" for more accurate function description
- ğŸ¯ **Menu Simplification**: Removed independent "Add Stock", "Edit Stock", "Delete Stock" options for optimized function integration
- âŒ¨ï¸ **Shortcut Operations**: Portfolio supports E key editing, D key deletion for more convenient and efficient operations
- ğŸ”„ **Real-time Updates**: Watchlist page added 5-second interval auto-refresh and update time display
- ğŸ”€ **Smart Navigation**: Auto-return to portfolio after completing edit/delete operations from portfolio list
- ğŸ¯ **Real Data**: Removed hardcoded mapping and simulated data, only display real API-acquired stock information

**v3.0 - Configuration System & Comprehensive Multi-language Support**

**Major Updates**:
- âš™ï¸ **YAML Configuration File**: New `config.yaml` system configuration file for customizable startup parameters
- ğŸŒ **Complete Multi-language Support**: Full support for Chinese and English interfaces, including all menus and interactions
- ğŸ¨ **Cultural Color Adaptation**: Chinese interface (red=gain/green=loss) vs English interface (green=gain/red=loss)
- ğŸ”§ **Secondary Language Selection**: Dedicated language selection page for better user experience

**Configuration Features**:
- ğŸ“ **Configurable Options**: Default language, auto-start mode, debug switch, display settings, update intervals, etc.
- ğŸ’¾ **Real-time Save**: Settings modified through interface (language, debug mode) automatically saved to config file
- ğŸ›¡ï¸ **Error Handling**: Automatically uses default configuration when config file is missing or has format errors
- ğŸ“– **Bilingual Comments**: Configuration file includes detailed Chinese and English explanations

**Multi-language Enhancements**:
- ğŸ”„ **Interface Localization**: All user interface text completely localized
- ğŸ¯ **Smart Adaptation**: Automatically adjusts color display standards based on language
- ğŸ“± **Consistent Experience**: All modules (monitoring, adding, editing, searching, deleting) unified multi-language support

**v2.5 - Interface Logic Optimization**
- âœ¨ **Smart Startup**: Auto-enter monitoring mode when portfolio data exists
- ğŸ¯ **One-click Access**: Main menu "Stock List" directly enters real-time monitoring
- âª **Multi-key Return**: Support ESC, Q, M keys for multiple return methods
- ğŸ§¹ **Streamlined Menu**: Remove duplicate functions, cleaner menu
- ğŸ’¬ **Message Management**: Fix persistent success message issues

**v2.4 - Stock Editing & Enhanced Stock List View**
- âœ… New stock editing feature: Modify cost price and quantity of existing stocks through interactive interface
- âœ… Enhanced stock list view: Real-time price fetching with display of today's change, daily P&L, total P&L, P&L rate, and market value
- âœ… Unified color display logic: Stock list view uses same color scheme as monitoring interface
- âœ… Portfolio summary: Stock list view shows overall P&L statistics at bottom
- âœ… Interaction optimization: Pre-fill current values when editing stocks for better user experience

**v2.3 - Smart Color Display System**
- âœ… Smart color judgment: Each value determines color based on its own value
- âœ… White neutral display: Zero values shown in white (e.g., 0% today's change, $0 daily P&L)
- âœ… Precise floating-point comparison: Uses epsilon values to avoid precision issues
- âœ… Professional stock software color standards: Red up, green down, white flat

**v2.2 - Stock Monitoring Data Enhancement**
- âœ… Added open price, high price, low price display
- âœ… Real-time today's change calculation: based on previous close fluctuation
- âœ… Upgraded monitoring table to 13-column detailed data display
- âœ… Optimized table column order: Today's change positioned left of daily P&L
- âœ… Tencent API and mock data support complete price data

**v2.1 - Stock List View Feature**
- âœ… Added stock list view function with table display of stock basic information
- âœ… Display serial number, stock code, stock name, quantity, cost price
- âœ… Portfolio statistics information display
- âœ… Optimized main menu structure and user interaction experience

**v2.0 - Bubble Tea Refactored Version**
- âœ… Integrated Bubble Tea framework for modern terminal interface
- âœ… Real-time keyboard response without confirmation prompts
- âœ… Used go-pretty library to solve Chinese character alignment issues
- âœ… Added profit/loss color display (red for profit, green for loss)
- âœ… Enhanced price display precision to 3 decimal places
- âœ… Stock separators for improved table readability

**v1.0 - Base Version**
- âœ… Multi-API data sources (Tencent Finance, Finnhub, Mock Data)
- âœ… Chinese stock name GBK encoding conversion
- âœ… Basic command-line interactive interface
- âœ… JSON data persistence storage

</details>

## ğŸ“ Usage Notes

### âœ¨ Product Highlights

- ğŸ® **Modern Experience**: Smooth terminal interface built with Bubble Tea framework
- ğŸ” **Precise Data**: 3 decimal precision, professional-grade data display
- ğŸŒ **Global Support**: Complete coverage of A-shares, US stocks, Hong Kong stocks
- ğŸ’¾ **Data Persistence**: Local JSON storage, never lose data
- ğŸŒˆ **Smart Display**: Professional stock software color scheme

### ğŸ“… Optimal Usage Times

| Time Period | Market Status | Data Quality |
|-------------|---------------|-------------|
| **09:30-15:00** | ğŸŸ¢ A-Share Trading Hours | â­â­â­â­â­ Real-time Data |
| **21:30-04:00** | ğŸ‡ºğŸ‡¸ US Trading Hours | â­â­â­â­â­ Real-time Data |
| **Non-trading Hours** | ğŸ”´ Market Closed | â­â­â­ Previous Close Price |

### ğŸš€ Quick Start Guide

1. **First Time Use**: Enter main menu directly, add some stocks first
2. **After Adding**: Program auto-enters monitoring mode on restart
3. **Daily Use**: View real-time data directly, adjust positions when needed

---

> ğŸ“ **Friendly Reminder**: Please use during trading hours for most accurate data. Non-trading hours display the last trading price.