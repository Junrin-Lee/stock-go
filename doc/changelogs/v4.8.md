# 🌟 v4.8 - 多标签系统与用户体验优化

**发布时间**: 2025年

**更新类型**: 🚀 **功能增强更新**

## 🏷️ 多标签系统

- ✅ **多标签支持**: 自选股票现在支持添加多个标签，不再限于单一标签
- ✅ **标签管理增强**: 全新的标签管理界面，支持添加、删除、编辑标签操作
- ✅ **标签编辑功能**: 支持修改已有标签名称，批量更新所有使用该标签的股票
- ✅ **标签删除功能**: 支持从单只股票移除特定标签

## 🎨 持仓股票高亮显示

- ✅ **自选列表高亮**: 在自选列表中，同时存在于持仓列表的股票会高亮显示
- ✅ **可配置颜色**: 新增 `display.portfolio_highlight` 配置项，支持自定义高亮颜色
- ✅ **颜色工具类**: 新增 `color.go` 颜色工具模块，支持 go-pretty 库的 8 种标准颜色
- ✅ **支持颜色**: black, red, green, yellow, blue, magenta, cyan, white

## 🔧 排序系统优化

- ✅ **实时排序修复**: 修复排序后数据不随实时股价更新的问题
- ✅ **排序模块独立**: 新增 `sort.go` 独立排序模块，提升代码可维护性
- ✅ **缓存数据排序**: 排序现在基于缓存的实时数据，避免 API 调用，保持顺序正确
- ✅ **性能优化**: 优化排序算法，减少排序延迟

## ✏️ 输入交互增强

- ✅ **光标控制**: 添加/修改股票时支持光标移动编辑
- ✅ **方向键支持**: 支持左右方向键在输入框中移动光标位置
- ✅ **删除增强**: 支持 Backspace/Delete 在光标位置删除字符
- ✅ **编辑体验**: 大幅提升股票代码、成本价、数量等输入字段的编辑体验

## 🗑️ 架构简化

- ✅ **移除 AKShare 依赖**: 移除 Python AKShare 依赖，简化项目架构
- ✅ **删除 Python 脚本**: 删除 `scripts/akshare_fund_flow.py` 脚本
- ✅ **纯 Go 实现**: 项目现在是纯 Go 语言实现，不再需要 Python 环境
- ✅ **依赖精简**: 减少外部依赖，提升部署便捷性

## 🐛 Bug 修复

- ✅ **空数据处理**: 修复空数据时的显示问题
- ✅ **自选列表修复**: 修复自选列表相关的多个 bug
- ✅ **排序延迟修复**: 修复排序功能的延迟问题

## 📋 核心改进

```
多标签系统: 自选股票支持多个标签，全新标签管理界面
持仓高亮: 自选列表中持仓股票高亮显示，可配置颜色
排序优化: 实时排序，基于缓存数据，性能提升
输入增强: 光标控制，方向键移动，编辑体验优化
架构简化: 移除 Python 依赖，纯 Go 实现
```

## ⌨️ 快捷键变化

**自选列表标签管理**：
```
T 键 → 进入标签管理界面
  ├─ 添加新标签
  ├─ 从现有标签选择
  ├─ 编辑标签名称
  └─ 删除标签
```

## ⚙️ 新增配置项

```yaml
display:
    # 持仓股票高亮颜色
    # 自选列表中同时在持仓中的股票名称高亮颜色
    # 支持: black, red, green, yellow, blue, magenta, cyan, white
    portfolio_highlight: "yellow"
```

## 📁 项目结构变化

**新增文件**：
- `color.go` - 颜色工具类
- `sort.go` - 独立排序模块

**删除文件**：
- `scripts/akshare_fund_flow.py` - Python 资金流向脚本

## 🔄 与v4.7对比优势

| 特性 | v4.7架构优化版本 | v4.8多标签版本 |
|-----|----------------|----------------|
| 标签系统 | ✅ 单标签支持 | ✅ 多标签 + 标签管理 |
| 持仓标识 | ❌ 无高亮 | ✅ 自选列表持仓高亮 |
| 排序实时性 | ⚠️ 可能延迟 | ✅ 实时更新 |
| 输入编辑 | ⚠️ 基础输入 | ✅ 光标控制编辑 |
| Python 依赖 | ✅ 需要 Python | ✅ 纯 Go，无需 Python |
| 代码模块化 | ✅ 常量分离 | ✅ 常量 + 颜色 + 排序分离 |

## 💡 升级建议

1. **配置文件**: 如需自定义持仓高亮颜色，请在配置文件中添加 `display.portfolio_highlight` 配置项
2. **Python 环境**: 如之前安装了 Python 环境用于资金流向功能，现在可以删除 `venv` 目录
3. **多标签迁移**: 原有的单标签数据会自动兼容，无需手动迁移
